<!DOCTYPE html>
<!-- saved from url=(0093)https://gitbook.corp.sdo.com/intermediateclient/book/Unity3D_Animation/Unity3D_Animation.html -->
<html lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
        
        <title>动画 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="./动画 · GitBook_files/style.css">

    
            
                
                <link rel="stylesheet" href="./动画 · GitBook_files/website.css">
                
            
                
                <link rel="stylesheet" href="./动画 · GitBook_files/search.css">
                
            
                
                <link rel="stylesheet" href="./动画 · GitBook_files/website(1).css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://gitbook.corp.sdo.com/intermediateclient/book/Unity3D_Animation/gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="https://gitbook.corp.sdo.com/intermediateclient/book/Unity3D_Animation/gitbook/images/favicon.ico" type="image/x-icon">

    
    
    
    

    <style></style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><link rel="prev" href="https://gitbook.corp.sdo.com/intermediateclient/book/camera.html"><link rel="next" href="https://gitbook.corp.sdo.com/intermediateclient/book/Unity3D_physics.html"></head>
    <body><div id="MathJax_Message" style="display: none;"></div>
        
<div class="book font-size-2 font-family-1 with-summary">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search">
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="https://gitbook.corp.sdo.com/intermediateclient/">
            
                    
                    目录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../programming-language.html">
            
                <a href="https://gitbook.corp.sdo.com/intermediateclient/book/programming-language.html">
            
                    
                    编程语言
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../multithread.html">
            
                <a href="https://gitbook.corp.sdo.com/intermediateclient/book/multithread.html">
            
                    
                    多线程编程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../network.html">
            
                <a href="https://gitbook.corp.sdo.com/intermediateclient/book/network.html">
            
                    
                    网络编程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../unity.html">
            
                <a href="https://gitbook.corp.sdo.com/intermediateclient/book/unity.html">
            
                    
                    Unity基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../unity-editor.html">
            
                <a href="https://gitbook.corp.sdo.com/intermediateclient/book/unity-editor.html">
            
                    
                    Unity Editor基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../ui.html">
            
                <a href="https://gitbook.corp.sdo.com/intermediateclient/book/ui.html">
            
                    
                    UI基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../3dMathAndRendering/3dMath.html">
            
                <a href="https://gitbook.corp.sdo.com/intermediateclient/book/3dMathAndRendering/3dMath.html">
            
                    
                    3D数学基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../3dMathAndRendering/3dRendering.html">
            
                <a href="https://gitbook.corp.sdo.com/intermediateclient/book/3dMathAndRendering/3dRendering.html">
            
                    
                    3D图形学基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../camera.html">
            
                <a href="https://gitbook.corp.sdo.com/intermediateclient/book/camera.html">
            
                    
                    摄像机
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.11" data-path="Unity3D_Animation.html">
            
                <a href="https://gitbook.corp.sdo.com/intermediateclient/book/Unity3D_Animation/Unity3D_Animation.html">
            
                    
                    动画
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../Unity3D_physics.html">
            
                <a href="https://gitbook.corp.sdo.com/intermediateclient/book/Unity3D_physics.html">
            
                    
                    物理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../Unity3D_ResourcesMgr/Unity3D_ResourcesMgr.html">
            
                <a href="https://gitbook.corp.sdo.com/intermediateclient/book/Unity3D_ResourcesMgr/Unity3D_ResourcesMgr.html">
            
                    
                    资源管理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../Unity3D_Rendering.html">
            
                <a href="https://gitbook.corp.sdo.com/intermediateclient/book/Unity3D_Rendering.html">
            
                    
                    渲染
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../Unity3D_Profile/Unity_Profiler_CPU_GPU.html">
            
                <a href="https://gitbook.corp.sdo.com/intermediateclient/book/Unity3D_Profile/Unity_Profiler_CPU_GPU.html">
            
                    
                    Profile
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com/" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <a class="btn pull-left js-toolbar-action" aria-label="" href="https://gitbook.corp.sdo.com/intermediateclient/book/Unity3D_Animation/Unity3D_Animation.html#"><i class="fa fa-align-justify"></i></a><div class="dropdown pull-right js-toolbar-action"><a class="btn toggle-dropdown" aria-label="Share" href="https://gitbook.corp.sdo.com/intermediateclient/book/Unity3D_Animation/Unity3D_Animation.html#"><i class="fa fa-share-alt"></i></a><div class="dropdown-menu dropdown-left"><div class="dropdown-caret"><span class="caret-outer"></span><span class="caret-inner"></span></div><div class="buttons"><button class="button size-5 ">Facebook</button><button class="button size-5 ">Google+</button><button class="button size-5 ">Twitter</button><button class="button size-5 ">Weibo</button><button class="button size-5 ">Instapaper</button></div></div></div><a class="btn pull-right js-toolbar-action" aria-label="" href="https://gitbook.corp.sdo.com/intermediateclient/book/Unity3D_Animation/Unity3D_Animation.html#"><i class="fa fa-facebook"></i></a><a class="btn pull-right js-toolbar-action" aria-label="" href="https://gitbook.corp.sdo.com/intermediateclient/book/Unity3D_Animation/Unity3D_Animation.html#"><i class="fa fa-twitter"></i></a><div class="dropdown pull-left font-settings js-toolbar-action"><a class="btn toggle-dropdown" aria-label="Font Settings" href="https://gitbook.corp.sdo.com/intermediateclient/book/Unity3D_Animation/Unity3D_Animation.html#"><i class="fa fa-font"></i></a><div class="dropdown-menu dropdown-right"><div class="dropdown-caret"><span class="caret-outer"></span><span class="caret-inner"></span></div><div class="buttons"><button class="button size-2 font-reduce">A</button><button class="button size-2 font-enlarge">A</button></div><div class="buttons"><button class="button size-2 ">Serif</button><button class="button size-2 ">Sans</button></div><div class="buttons"><button class="button size-3 ">White</button><button class="button size-3 ">Sepia</button><button class="button size-3 ">Night</button></div></div></div><h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="https://gitbook.corp.sdo.com/intermediateclient/">动画</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="">#</h2>
<h3 id="创建动画的一个基本步骤"><strong>创建动画的一个基本步骤</strong></h3>
<p>创建动画的一个基本步骤是设置一个unity3d可理解的简化后的骨骼到骨架中实际骨骼的映射；在Mecanim的术语中，这个映射称为Avatar，即avatar是骨骼到骨架的映射。Avatar主要用于类人骨骼模型，可以实现角色之间的Retargeting。非类人模型可以认为骨架就是骨骼。</p>
<p>三个选项卡介绍</p>
<p><img src="./动画 · GitBook_files/tab3.png" alt=""></p>
<p><strong>Model:</strong></p>
<ul>
<li>1.scale factor 模型缩放比例，不同建模软件导入比例不一样，unity的物理单位是1m，这个根据不同建模软件设置</li>
<li>2.readable/writeable和UITexture一样，如果开了unity就必须拷一份到内存，尽量不开。</li>
<li>3.Generate Colliders一般用于生成场景的mesh collider，其他地方就不要打开了。</li>
<li>4.Normals&amp;Tangents是导入时对顶点和切线的处理，比如是否导入模型的顶点等，可限制模型精度和影响后续渲染等，比如vfshader就需要用到模型的 normal。</li>
</ul>
<p><strong>Rig：</strong></p>
<ul>
<li><ol>
<li>这里Animation Type包括（Generic/Humanoid/Legacy/None）</li>
</ol>
</li>
<li><ol>
<li>Generic 用于非类人模型；Humanoid用于类人模型</li>
</ol>
</li>
<li><ol>
<li>Avatar Definition:可以使用现有的avatar，也可以create from this model，一般地，模型网格文件选create，这个时候，Avatar子资产被增加到模型资产的下面，即Avatar是unity根据网格文件生成的，对Humanoid类型，还会自动匹配骨骼到骨架，不符合会报错；而动画文件使用copy，使用已有资源。</li>
</ol>
</li>
</ul>
<p><strong>Animations:</strong></p>
<ul>
<li><ol>
<li>clip片段的Start和End参数，表示从一个fbx动画中截取一段给clip使用，多个clip共用一个动画资源，所以，可以一个模型的所有动作都搞到一个动画文件中，各个动作去里面取一段即可；也可以一个模型每个动作都有一个动画文件，分开管理。</li>
</ol>
</li>
</ul>
<h3 id="animator系统的几个概念"><strong>Animator系统的几个概念</strong></h3>
<h4 id="animationevent"><strong>AnimationEvent</strong></h4>
<p>这个在animations页签的下面，可以给clip加帧事件，即播到某帧时触发某个事件：
给clip的某些帧上加event,这个Function就是事件的名字，其他的是这个函数的参数定义一个脚本来接受这个事件，比如这个图需要定义一个脚本，并且脚本里定义了void ani(xxx){}函数参数的处理：根据脚本的函数定义格式传参数，比如void ani(int a)，则传Int那个参数，ani(Object a)则传Object那个参数，ani(float a, string b)则传Float和String这2个参数，而，ani(AnimationnEvent a)则传整个event进去（包括所有参数和当前event对应的clip的信息）ps:添加了event的clip的animator物体必须挂上定义了该事件名Function的函数的脚本，否则会报错</p>
<p>event机制的主要应用场景：声效的绑定，在无物理模拟的情况下模拟碰撞事件等，不建议游戏逻辑部分通过AnimationEvent来触发</p>
<h4 id="animationcurve"><strong>AnimationCurve</strong></h4>
<p>以播放时间作为横轴，通过Animator.Get参数（一个Curve的name）获得当前数值，在播放逻辑中方便</p>
<h4 id="animation-layers和mask"><strong>Animation Layers和Mask</strong></h4>
<p>Animation Layers主要控制动作的融合播放，可以结合如下吃苹果动画的例子来理解</p>
<p>1.给吃苹果动画加遮罩：在animation tab中的Mask中加遮罩，只勾选吃苹果的那部分骨骼，3种情况添加：　
　　　　</p>
<ul>
<li>A.加现有的遮罩文件，可以通过Assets-&gt;Create-&gt;Avatar Mast创建一个遮罩</li>
<li>B.如果是给类人模型的动画，使用点击部位加遮罩</li>
<li>C.如果是通用模型的动画，勾选关节加遮罩</li>
</ul>
<p>2.创建新Layer:EatApple Layer, 把第1步的遮罩拖到这里的Mask参数中，设置该layer设置比走路动画Layer高，并设置该Layer的Blending为override，这样，播走路动画和播吃苹果动画就可以同时进行并且播苹果动画override了走路动画的上半身动画。</p>
<p>　　</p>
<h4 id="animator-override-controller："><strong>Animator Override Controller：</strong></h4>
<p>是Override “Animator Controller”的重载
Animation Controller可以认为它就是动画状态机, Animator动画系统是通过Animator Controller来控制动画播放的，里面存着指向各个动画片段Animation Clip的引用，和播放动画的逻辑，比如状态转移等.</p>
<p>而Animator Override Controller则用于拓展一个已存在的Animtor Controller,它只是在后者基础上可以在某些状态播新的动画Clip，保持后者的状态机逻辑，结构</p>
<p>应用方面，Animator Override Controller能做到一个状态机（Animator Controller）实现多套动作，非常利于维护。按官方说法就是：</p>
<p>如果一类模型可以共用动画状态机，则可以弄一个基础Animtor Controller，里面是基本的动画状态逻辑，然后给某个模型使用就弄一个Animtor Override Controller,然后把其中不同的动画Clip换成自己的，这样就只需维护一份动画状态机了，省心省力。比如NPC系统的各个NPC。许多怪物也可以共用。</p>
<h4 id="blendtree混合树"><strong>blendtree混合树</strong></h4>
<ul>
<li><ol>
<li>状态转移和混合树，虽然两者都是用来制作平滑动画，但区别很大</li>
</ol>
</li>
<li><ol>
<li>状态转移是从一个动画状态平滑转移到另外一个动画状态 </li>
</ol>
</li>
<li><ol>
<li>动画混合树是把多个动画混合起来, 将角色不同的部分混合，对一个部分而言，是混合所有动画中该部分的动作，形成该部分的新动作，是混合动画。</li>
</ol>
</li>
<li><ol>
<li>可以通过参数控制各个动画的混合权重，以达到目的.</li>
</ol>
</li>
<li><ol>
<li>要使混合效果好，各个动画需要造型类似，这个和转移动画不同；动画混合树作为一种特殊的状态存在在动画状态机中，是一个新的状态。</li>
</ol>
</li>
<li><ol>
<li>鉴于上述描写，制作混合树的子动画需要注意：
走路动画和奔跑动画都在0.7的时候右脚触地，不然0.7的时刻融合后，右脚在半空，也就是说动作在一些关键点比如离地和触地。在时间线上的百分比应该相近的</li>
</ol>
</li>
</ul>
<h4 id="混合树的创建，"><strong>混合树的创建，</strong></h4>
<p>选一个State-&gt;create blend tree，双击blend tree进入混合树编辑页面，右边Inspector中就是控制这个混合树混合的anim clips和参数。</p>
<ul>
<li><p>一些参数：有一个Compute Thresholds的参数，可以帮忙指定各种阈值控制混合。比如X方向的速度等。</p>
</li>
<li><p>给混合树添加已创建的参数：在Parameter选择栏里手动键入，这个同给动画状态机加参数是一样的</p>
</li>
<li><p>上面是针对一维混合，二维混合一般用不到 , 多维混合可以用于控制脸部表情，多维混合的做法（拿控制脸部表情做例子）：给出多个表情动画，每个动画对应一个参数控制混合的权重，这样通过控制各个参数可以“生产”出很多有意思的表情动画。</p>
</li>
</ul>
<h4 id="root-motion根运动"><strong>root motion根运动</strong></h4>
<p>直观解释,根运动是动画本身自带的，比如行走动画，如果不apply root motion则“原地踏步”(in-place),如果应用则向前行走。
实际项目中一般，不apply root motion，而通过代码来设置transform postion，总结而言：</p>
<h4 id="一些优化建议"><strong>一些优化建议</strong></h4>
<ul>
<li>1.如果Animator Control没有被赋值，并不会消耗Animnator的运行逻辑</li>
<li>2.少用缩放动画曲线</li>
<li>3.如果是类人动画，用身体遮罩剔除IK Goals和不需要的细节动画（如手指动画）</li>
<li>4.如果选通用模式，不要使用root motion，不要选择root bone</li>
<li>5.用Hashid而不用string来获取动画状态或参数，动画的Play函数重载了hash和string，可以考虑做一个映射，string-&gt;hash，使用hash获取参数（播动画），来代替string.</li>
<li>6.使用curves来实现一些额外表现：在播动画的时候同时进行</li>
<li>7.Rig页的optimize gameobjects（选create from this model才可用）</li>
</ul>
<h3 id="skinnedmeshrenderer"><strong>SkinnedMeshRenderer</strong></h3>
<p>蒙皮网格用于渲染人物。人物动画使用的骨骼，其中每个骨骼影响网格的一部分。多个骨骼的影响相同的顶点和的权重。使用Unity骨骼蒙皮的主要优势是可以使骨骼受到物理影响，制作你的角色布娃娃。您可以启用/禁用通过脚本的骨骼</p>
<h4 id="quality-质量"><strong>Quality 质量</strong></h4>
<p>Unity可以用1，2，或4骨骼顶点蒙皮。4骨骼权重有较好表现但费计算资源。2骨骼权重在游戏中经常用，移动端适配良好，如果Quality设置为自动，则允许最终用户选择质量设置，使游戏获得最佳性能。</p>
<h4 id="update-when-offscreen-and-bounds-画外和范围的更新"><strong>Update When Offscreen and Bounds 画外和范围的更新</strong></h4>
<p>默认情况下，蒙皮网格不可见网格并不会更新。直到网格返回屏幕上时，蒙皮才会更新。这是一个重要性能优化点,这可以让你周围有很多角色，当它们不可见时，运行时不被采取任何处理。</p>
<h4 id="meshbindposes-绑定的姿势"><strong>Mesh.bindposes 绑定的姿势</strong></h4>
<p>bindposes : Matrix4x4[]</p>
<ul>
<li>绑定的姿势。每个索引绑定的姿势使用具有相同索引的骨骼。</li>
<li>当骨骼在绑定的姿势时，绑定的姿势是骨骼变换矩阵的倒转。</li>
</ul>
<p>这里阐述下BindPose是如何参与在骨骼蒙皮运算中的
根据Unity文档, Unity中BindPose的算法如下:</p>
<blockquote>
<p>OneBoneBindPose = bone.worldToLocalMatrix * transform.localToWorldMatrix;</p>
</blockquote>
<p>骨骼的世界转局部坐标系矩阵乘上Mesh的局部转世界矩阵</p>
<p>bindposes的主要作用在骨骼变换前预制一些骨骼变换，使得人物可以在同一动画上有不同的骨骼位置表现，简化工作流等</p>
<h3 id="unity-蒙皮算法"><strong>Unity 蒙皮算法</strong></h3>
<p>把三维骨骼顶点联系至骨骼的位置的过程，称为蒙皮。
蒙皮用的网格是通过顶点联系上骨骼，每个顶点可以绑定一个或者多个骨骼（一般最多允许4根骨骼）。若某顶点只绑定至一根骨骼，它就会完全跟随该骨骼移动。若绑定至多个骨骼，该顶点的位置就等于把它逐一绑定个别骨骼，在通过权重加权平均。</p>
<p>能把网格顶点从原来位置（绑定姿势）变换至骨骼的当前姿势的矩阵称为蒙皮矩阵。蒙皮矩阵把顶点变形至新位置，顶点在变换前后都在模型变换空间中。</p>
<p>求蒙皮矩阵时的一个诀窍是：顶点绑定到关节的位置时，在该关节空间中是不变的（其实变的只是骨骼，所以才叫骨骼动画）。</p>
<p>通俗点一点理解就是：模型加载到内存中的位置是在模型空间中的坐标（并不是其绑定的骨骼坐标系下）在做骨骼动画时，动的其实是骨骼，而绑定到该骨骼的顶点会跟随骨骼做动画，所以顶点相对于骨骼位置是不变的（在关节空间下是不变的，变的只是骨骼的位置），因此可以利用这个特性，求出蒙皮矩阵。</p>
<h4 id="unity中的-lbs蒙皮算法"><strong>Unity中的 LBS蒙皮算法</strong></h4>
<pre><code>for (int vert = 0; vert &lt; verts.Count; ++vert)
{
    Vector3 point = verts[vert];
    BoneWeight weight = Weights[vert];

    List&lt;Transform&gt; transSet = bones;

    Transform trans0 = bones[weight.boneIndexs[0]];
    Transform trans1 = bones[weight.boneIndexs[1]];
    Transform trans2 = bones[weight.boneIndexs[2]];
    Transform trans3 = bones[weight.boneIndexs[3]];

    Matrix4x4 tempMat0 = trans0.localToWorldMatrix *  bindPoses[weight.boneIndexs[0]];
    Matrix4x4 tempMat1 = trans1.localToWorldMatrix *  bindPoses[weight.boneIndexs[1]];
    Matrix4x4 tempMat2 = trans2.localToWorldMatrix *  bindPoses[weight.boneIndexs[2]];
    Matrix4x4 tempMat3 = trans3.localToWorldMatrix *  bindPoses[weight.boneIndexs[3]];

    Vector3 temp = tempMat0.MultiplyPoint(point) * weight.weights[0] +
                           tempMat1.MultiplyPoint(point) * weight.weights[1] +
                           tempMat2.MultiplyPoint(point) * weight.weights[2] +
                           tempMat3.MultiplyPoint(point) * weight.weights[3];

    verts[vert] = srender.transform.worldToLocalMatrix.MultiplyPoint(temp);
}
</code></pre><h4 id="一些有价值的链接"><strong>一些有价值的链接</strong></h4>
<p>SkinnedMeshRenderer范例</p>
<p><a href="https://github.com/happyfire/SkinnedMeshDemo" target="_blank">https://github.com/happyfire/SkinnedMeshDemo</a></p>
<p>在使用SkinnedMeshRenderer时的代码规范</p>
<p><a href="http://www.mamicode.com/info-detail-1350600.html" target="_blank">http://www.mamicode.com/info-detail-1350600.html</a></p>
<h3 id="视频-动画"><a href="https://gitbook.corp.sdo.com/intermediateclient/video_Animation.html">视频-动画</a></h3>
<script type="text/javascript">var targetUl = document.getElementsByClassName('page-inner')[0].getElementsByTagName('ul')[0];if(targetUl.getElementsByTagName('a').length>0){targetUl.className='toc';}</script>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class="search-results-count"></span> results matching "<span class="search-query"></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class="search-query"></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="https://gitbook.corp.sdo.com/intermediateclient/book/camera.html" class="navigation navigation-prev " aria-label="Previous page: 摄像机">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="https://gitbook.corp.sdo.com/intermediateclient/book/Unity3D_physics.html" class="navigation navigation-next " aria-label="Next page: 物理" style="margin-right: 0px;">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"动画","level":"1.11","depth":1,"next":{"title":"物理","level":"1.12","depth":1,"path":"book/Unity3D_physics.md","ref":"book/Unity3D_physics.md","articles":[]},"previous":{"title":"摄像机","level":"1.10","depth":1,"path":"book/camera.md","ref":"book/camera.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["mathjax","toc"],"pluginsConfig":{"toc":{"addClass":true,"className":"toc"},"mathjax":{"forceSVG":false,"version":"2.6-latest"},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"book/Unity3D_Animation/Unity3D_Animation.md","mtime":"2019-05-05T03:07:15.839Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-11-22T03:39:59.338Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="./动画 · GitBook_files/gitbook.js.下载"></script>
    <script src="./动画 · GitBook_files/theme.js.下载"></script>
    
        
        <script src="./动画 · GitBook_files/MathJax.js.下载" id=""></script>
        
    
        
        <script src="./动画 · GitBook_files/plugin.js.下载"></script>
        
    
        
        <script src="./动画 · GitBook_files/search-engine.js.下载"></script>
        
    
        
        <script src="./动画 · GitBook_files/search.js.下载"></script>
        
    
        
        <script src="./动画 · GitBook_files/lunr.min.js.下载"></script>
        
    
        
        <script src="./动画 · GitBook_files/search-lunr.js.下载"></script>
        
    
        
        <script src="./动画 · GitBook_files/buttons.js.下载"></script>
        
    
        
        <script src="./动画 · GitBook_files/fontsettings.js.下载"></script>
        
    

    


</body></html>