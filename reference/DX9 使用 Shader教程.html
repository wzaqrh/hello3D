<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0037)http://www.waitingfy.com/archives/395 -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link rel="shortcut icon" type="image/x-icon" href="http://www.waitingfy.com/wp-content/themes/green-apples/images/blog.ico" media="screen"><link type="text/css" media="screen" href="./DX9 使用 Shader教程_files/autoptimize_9a18e08c89ce894504639f243c0d2ef6.css" rel="stylesheet"><link type="text/css" media="all" href="./DX9 使用 Shader教程_files/autoptimize_a96654c2c19eab602c1918661709518d.css" rel="stylesheet"><title> 用一个Pixel Shader(像素着色器)来介绍HLSL | Waiting For You</title><link rel="alternate" type="application/rss+xml" title="Waiting For You RSS Feed" href="http://www.waitingfy.com/feed"><link rel="pingback" href="http://www.waitingfy.com/xmlrpc.php"><link rel="dns-prefetch" href="http://s.w.org/"><link rel="alternate" type="application/rss+xml" title="Waiting For You » 用一个Pixel Shader(像素着色器)来介绍HLSL评论Feed" href="http://www.waitingfy.com/archives/395/feed"> <script type="text/javascript">/*<![CDATA[*/window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.waitingfy.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.1"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);/*]]>*/</script><style></style><script src="./DX9 使用 Shader教程_files/wp-emoji-release.min.js.下载" type="text/javascript" defer=""></script> <link rel="stylesheet" id="dashicons-css" href="./DX9 使用 Shader教程_files/dashicons.min.css" type="text/css" media="all"> <script type="text/javascript" src="./DX9 使用 Shader教程_files/jquery.js.下载"></script> <link rel="https://api.w.org/" href="http://www.waitingfy.com/wp-json/"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.waitingfy.com/xmlrpc.php?rsd"><link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.waitingfy.com/wp-includes/wlwmanifest.xml"><link rel="prev" title="Illustrate a HLSL example by using Pixel Shade" href="http://www.waitingfy.com/archives/387"><link rel="next" title="Bubble Sort (冒泡排序 C++)" href="http://www.waitingfy.com/archives/403"><meta name="generator" content="WordPress 4.9.1"><link rel="canonical" href="http://www.waitingfy.com/archives/395"><link rel="shortlink" href="http://www.waitingfy.com/?p=395"><link rel="alternate" type="application/json+oembed" href="http://www.waitingfy.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.waitingfy.com%2Farchives%2F395"><link rel="alternate" type="text/xml+oembed" href="http://www.waitingfy.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.waitingfy.com%2Farchives%2F395&amp;format=xml"><meta name="keywords" content=""><meta name="description" content=""><meta name="author" content="waitingfy.com"><meta name="Copyright" content="waitingfy.com"><style></style></head><body><div id="page"><div id="top"></div><div id="header"><div id="headerimg"> <a href="http://www.waitingfy.com/">Waiting For You</a><div class="description">记录一些关于python, android,cocos2d-x,objective-c,mfc,directX,c++，数学的东西</div></div></div><div class="clear whitespace"></div><div id="container"><div id="content" class="narrowcolumn"><div class="navigation"><div class="alignleft"><a href="http://www.waitingfy.com/archives/387" rel="prev">Illustrate a HLSL example by using Pixel Shade</a></div><div class="alignright"><a href="http://www.waitingfy.com/archives/403" rel="next">Bubble Sort (冒泡排序 C++)</a></div></div><div class="clear"></div><div class="post-395 post type-post status-publish format-standard hentry category-directx" id="post-395"><div class="post-date"><div class="day">02</div><div class="month">2月</div></div><h1>用一个Pixel Shader(像素着色器)来介绍HLSL</h1><div class="entry"><div id="toc_container" class="no_bullets"><p class="toc_title">Contents</p><ul class="toc_list"><li><a href="http://www.waitingfy.com/archives/395#i">介绍:</a></li><li><a href="http://www.waitingfy.com/archives/395#_HLSL_Shader">写一个 HLSL Shader</a><ul><li><a href="http://www.waitingfy.com/archives/395#Globals">Globals(全局变量)</a></li><li><a href="http://www.waitingfy.com/archives/395#Input_and_Output_Structures">Input and Output Structures(输入输出结构)</a></li><li><a href="http://www.waitingfy.com/archives/395#Entry_function">Entry function(入口函数)</a></li></ul></li><li><a href="http://www.waitingfy.com/archives/395#_HLSL_Shader-2">编译一个 HLSL Shader</a><ul><li><a href="http://www.waitingfy.com/archives/395#Constant_Table">Constant Table(常量表)</a><ul><li><a href="http://www.waitingfy.com/archives/395#Getting_a_Handle_to_a_Constant">Getting a Handle to a Constant(获取常量的句柄)</a></li><li><a href="http://www.waitingfy.com/archives/395#Setting_Constants">Setting Constants(常量的设置)</a></li></ul></li><li><a href="http://www.waitingfy.com/archives/395#_HLSL_Shader-3">编译一个 HLSL Shader</a></li><li><a href="http://www.waitingfy.com/archives/395#Pixel_Shader">Pixel Shader(像素着色器) 的输入和输出</a></li><li><a href="http://www.waitingfy.com/archives/395#_Pixel_Shader">使用 Pixel Shader 的步骤</a><ul><li><a href="http://www.waitingfy.com/archives/395#Writing_and_Compiling_a_Pixel_Shader">Writing and Compiling a Pixel Shader</a></li><li><a href="http://www.waitingfy.com/archives/395#_Pixel_Shader-2">创建一个 Pixel Shader</a></li><li><a href="http://www.waitingfy.com/archives/395#Setting_a_Pixel_Shader">Setting a Pixel Shader(像素着色器的设置)</a></li><li><a href="http://www.waitingfy.com/archives/395#Pixel_Shader-2">Pixel Shader 销毁</a></li></ul></li></ul></li><li><a href="http://www.waitingfy.com/archives/395#i-2">应用完整代码</a><ul><li><a href="http://www.waitingfy.com/archives/395#Related_Posts">Related Posts</a></li></ul></li></ul></div><p><span style="font-size: 14px;"><span style="font-size: 18px;">首先我们来看下这个项目的效果，一个照片被”黑白化”</span></span></p><p>&nbsp;</p><p><img src="./DX9 使用 Shader教程_files/1355814975_7476.jpg" alt=""></p><p>&nbsp;</p><p><span style="font-size: 18px;">下面这张是原图。</span></p><p>&nbsp;</p><p>&nbsp;</p><p><img src="./DX9 使用 Shader教程_files/1355815002_7291.jpg" alt=""></p><p><span style="font-size: 18px;">我们来看下是如何实现的，首先你要有点知识关于“DirectX Texture(纹理)”. 如果你还没有的话，可以看下这篇文章 “<a title="DirectX 9.0 C++ 教程 Texture 纹理映射" href="http://www.waitingfy.com/?p=238">DirectX 9.0 C++ tutorial Texture </a>”.</span></p><p>&nbsp;</p><p><span style="font-size: 18px;">今天的主题是 HLSL and Pixel Shader(像素着色器), 这两个主题有点难。</span></p><p>&nbsp;</p><p>&nbsp;</p><h2><span id="i">介绍:</span></h2><p>&nbsp;</p><p><span style="font-size: 18px;">HLSL 是 “High-LevelShading Language” 的简写. 我们可以使用 HLSL去写一些小的 Pixel Shade 项目.简要地说, 顶点着色器和像素着色器就是我们自行编写的一些规模较小的定制程序。这些定制程序可取代固定功能流水线中的某一功能，并在图形卡的GPU中执行. 通过这种功能替换，我们便在实现各种图形效果时获得了巨大的灵活性。我们不再受制于那些预定义的固定运算。</span></p><p><span style="font-size: 14px;"><span style="font-size: 18px;">HLSL 的语法跟C,C++相似，我们可以很容易地学习它。</span></span></p><p>&nbsp;</p><p><img src="./DX9 使用 Shader教程_files/1355815108_4208.jpg" alt=""></p><p>&nbsp;</p><h2><span id="_HLSL_Shader">写一个 HLSL Shader</span></h2><p>&nbsp;</p><p><span style="font-size: 18px;">HLSL着色器程序可以以一个长字符串的形式出现在应用程序的源文件中. 但更方便也更模块化的做法是将着色器代码跟应用程序代码分离. 我们可在记事本编写着色器代码并将其保存为常见的ASCII文本文件. 接下来我们使用 D3DXComplileShaderFromFile 函数去编译我们的着色器。</span></p><p><span style="font-size: 14px;"><span style="font-size: 18px;">下面是Pixel Shader 例子</span></span></p><p>&nbsp;</p><div><div id="highlighter_979124" class="syntaxhighlighter notranslate cpp"><div class="toolbar"><span><a href="http://www.waitingfy.com/archives/395#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">//</code></div><div class="line number2 index1 alt1"><code class="cpp comments">// 全局变量</code></div><div class="line number3 index2 alt2"><code class="cpp comments">//</code></div><div class="line number4 index3 alt1"><code class="cpp plain">sampler BaseTex;</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="cpp comments">//</code></div><div class="line number7 index6 alt2"><code class="cpp comments">// input structures(输入结构)</code></div><div class="line number8 index7 alt1"><code class="cpp comments">//</code></div><div class="line number9 index8 alt2"><code class="cpp keyword bold">struct</code> <code class="cpp plain">PS_INPUT</code></div><div class="line number10 index9 alt1"><code class="cpp plain">{</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">float2 base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : TEXCOORD;</code></div><div class="line number12 index11 alt1"><code class="cpp plain">};</code></div><div class="line number13 index12 alt2"><code class="cpp comments">//</code></div><div class="line number14 index13 alt1"><code class="cpp comments">// output structures(输出结构)</code></div><div class="line number15 index14 alt2"><code class="cpp comments">//</code></div><div class="line number16 index15 alt1"><code class="cpp keyword bold">struct</code> <code class="cpp plain">PS_OUTPUT</code></div><div class="line number17 index16 alt2"><code class="cpp plain">{</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">vector color : COLOR;</code></div><div class="line number19 index18 alt2"><code class="cpp plain">};</code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2"><code class="cpp comments">//</code></div><div class="line number22 index21 alt1"><code class="cpp comments">//&nbsp; Main Function</code></div><div class="line number23 index22 alt2"><code class="cpp comments">//</code></div><div class="line number24 index23 alt1"><code class="cpp plain">PS_OUTPUT Main(PS_INPUT input)</code></div><div class="line number25 index24 alt2"><code class="cpp plain">{</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// zero out members of output</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">PS_OUTPUT output = (PS_OUTPUT)0;</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">vector b = tex2D(BaseTex,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; input.base);</code></div><div class="line number30 index29 alt1">&nbsp;</div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//核心代码，学过图形学的应该知道，对一个像素的颜色进行重新计算</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">vector c = 0.3 * b.x + 0.59 * b.y + 0.11 * b.z ;</code></div><div class="line number33 index32 alt2">&nbsp;</div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">output.color = c;</code></div><div class="line number35 index34 alt2">&nbsp;</div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">output;</code></div><div class="line number37 index36 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;</p><h3><span id="Globals"><span style="font-size: 24px;">Globals(全局变量)</span></span></h3><p>&nbsp;</p><p><span style="font-size: 18px;">开始我们初始化一个全局变量:</span></p><p><span style="font-size: 18px;">sampler BaseTex;</span></p><p>&nbsp;</p><p>&nbsp;</p><h3><span id="Input_and_Output_Structures"><span style="font-size: 24px;">Input and Output Structures(输入输出结构)</span></span></h3><p>&nbsp;</p><p><span style="font-size: 18px;">声明了全局变量之后, 我们定义了两个特殊结构.对于pixel shaders, 这些结构定义了我们着色器输入输出的 texture(纹理) 数据 。</span></p><div><div id="highlighter_796479" class="syntaxhighlighter notranslate cpp"><div class="toolbar"><span><a href="http://www.waitingfy.com/archives/395#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">struct</code> <code class="cpp plain">PS_INPUT</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">float2 base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : TEXCOORD;</code></div><div class="line number4 index3 alt1"><code class="cpp plain">};</code></div><div class="line number5 index4 alt2"><code class="cpp keyword bold">struct</code> <code class="cpp plain">PS_OUTPUT</code></div><div class="line number6 index5 alt1"><code class="cpp plain">{</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">vector color : COLOR;</code></div><div class="line number8 index7 alt1"><code class="cpp plain">};</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;</p><p>&nbsp;</p><p><span style="font-size: 18px;">在这个例子中，我们着色器的输入纹理坐标只有一个。输出包含了一个颜色信息。</span></p><p><span style="font-size: 18px;">其中 “: COLOR” 是说 vector(向量) color 是用于描述输出顶点的颜色信息。</span></p><p>&nbsp;</p><p>&nbsp;</p><h3><span id="Entry_function"><span style="font-size: 24px;">Entry function(入口函数)</span></span></h3><p>&nbsp;</p><p><span style="font-size: 18px;">像C++程序一样，每个HLSL程序都有一个入口点. 在我们的着色器例子中，入口函数为Main; 但是，这个名称并非强制性的. 着色器的入口函数的命名可以自由选择. 入口函数必须有一个接受输入结构的参数, 用来将texture coordinate 传给着色器。 而且入口函数必须返回一个输出结构的实例, 用来将经过处理的顶点自着色器输出。</span></p><p>&nbsp;</p><p>&nbsp;</p><h2><span id="_HLSL_Shader-2"><span style="font-size: 24px;">编译一个 HLSL Shader</span></span></h2><p>&nbsp;</p><h3><span id="Constant_Table"><span style="font-size: 24px;">Constant Table(常量表)</span></span></h3><p>&nbsp;</p><p>&nbsp;</p><p><span style="font-size: 18px;">每个着色器都用Constant Table来存储其变量. 为了使应用程序能够访问着色器的Constant Table,D3DX提供了接口 ID3DXConstantTable. 通过这接口，我们可以在应用程序源代码中对着色器源代码的变量进行设置。</span></p><p>&nbsp;</p><p>&nbsp;</p><h4><span id="Getting_a_Handle_to_a_Constant"><span style="font-size: 24px;">Getting a Handle to a Constant(获取常量的句柄)</span></span></h4><p>&nbsp;</p><p>&nbsp;</p><p><span style="font-size: 18px;">为了从应用程序的源代码中对着色器程序中的某个变量进行设置, 我们需要用某种方式来引用该变量。D3DXHANDLE类型的句柄恰合此意。下面的函数将返回一个引用了该变量的D3DXHANDLE类型的句柄</span></p><div><div id="highlighter_446875" class="syntaxhighlighter notranslate cpp"><div class="toolbar"><span><a href="http://www.waitingfy.com/archives/395#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">D3DXHANDLE ID3DXConstantTable::GetConstantByName(</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">D3DXHANDLE hConstant, </code><code class="cpp comments">// scope of constant</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">LPCSTR</code> <code class="cpp plain">pName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="cpp comments">// name of constant</code></div><div class="line number4 index3 alt1"><code class="cpp plain">);</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;</p><p><span style="font-size: 18px;">举一个例子，如果期望引用的着色器中的变量名称为 “BaseTex” 而且该变量为顶级参数，我们可以这样引用：</span></p><p>&nbsp;</p><p><span style="font-size: 18px;">D3DXHANDLE h0;</span></p><p><span style="font-size: 18px;">H0 = ConstTable-&gt;GetConstantByName(0, “BaseTex”);</span></p><p>&nbsp;</p><p>&nbsp;</p><h4><span id="Setting_Constants"><span style="font-size: 24px;">Setting Constants(常量的设置)</span></span></h4><p>&nbsp;</p><p><span style="font-size: 18px;">一旦应用程序获取了着色器代码中希望被引用的对那个变量的 D3DXHANDLE 类型的句柄, 我们就可在应用程序中使用方法 ID3DXConstantTable::SetXXX 对该变量进行设置, 其中XXX表示被设置变量的类型名称。 如果我们希望设置的变量为一个Sampler State, 那么该方法对应为 SetSampleState.</span></p><p><span style="font-size: 18px;">方法 ID3DXConstantTable::SetXXX 的通用签名:</span></p><div><div id="highlighter_213179" class="syntaxhighlighter notranslate cpp"><div class="toolbar"><span><a href="http://www.waitingfy.com/archives/395#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">HRESULT</code> <code class="cpp plain">ID3DXConstantTable::SetXXX(</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LPDIRECT3DDEVICE9 pDevice,</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">D3DXHANDLE hConstant,</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">XXX value</code></div><div class="line number5 index4 alt2"><code class="cpp plain">);</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;</p><p><span style="font-size: 18px;">一个例子:</span></p><p><span style="font-size: 18px;">LPDIRECT3DDEVICE9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; g_pd3dDevice;</span></p><p><span style="font-size: 18px;">D3DXCONSTANT_DESC BaseTexDesc;</span></p><p><span style="font-size: 18px;">g_pd3dDevice-&gt;SetSamplerState(BaseTexDesc.RegisterIndex,D3DSAMP_MAGFILTER, D3DTEXF_LINEAR);</span></p><p>&nbsp;</p><p>&nbsp;</p><h3><span id="_HLSL_Shader-3"><span style="font-size: 24px;">编译一个 HLSL Shader</span></span></h3><p><span style="font-size: 18px;">我们可用下面的函数对保存在文本文件中的着色器进行编译。</span></p><div><div id="highlighter_59948" class="syntaxhighlighter notranslate cpp"><div class="toolbar"><span><a href="http://www.waitingfy.com/archives/395#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">HRESULT</code> <code class="cpp plain">D3DXCompileShaderFromFile(</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">LPCSTR</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="cpp plain">pSrcFile,</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">CONST D3DXMACRO*&nbsp;&nbsp;&nbsp;&nbsp; pDefines,</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LPD3DXINCLUDE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pInclude,</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">LPCSTR</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="cpp plain">pFunctionName,</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">LPCSTR</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="cpp plain">pTarget,</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">DWORD</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="cpp plain">Flags,</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LPD3DXBUFFER*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ppShader,</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LPD3DXBUFFER*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ppErrorMsgs,</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LPD3DXCONSTANTTABLE* ppConstantTable</code></div><div class="line number11 index10 alt2"><code class="cpp plain">);</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;</p><div><div id="highlighter_554866" class="syntaxhighlighter notranslate cpp"><div class="toolbar"><span><a href="http://www.waitingfy.com/archives/395#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">Here is an example call of D3DXCompileShaderFromFile:</code></div><div class="line number2 index1 alt1"><code class="cpp comments">//</code></div><div class="line number3 index2 alt2"><code class="cpp comments">// Compile shader</code></div><div class="line number4 index3 alt1"><code class="cpp comments">//</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="cpp plain">ID3DXConstantTable* TransformConstantTable = 0;</code></div><div class="line number7 index6 alt2"><code class="cpp plain">ID3DXBuffer* shader&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = 0;</code></div><div class="line number8 index7 alt1"><code class="cpp plain">ID3DXBuffer* errorBuffer = 0;</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="cpp plain">hr = D3DXCompileShaderFromFile(</code><code class="cpp string">"hlslTexture.txt"</code><code class="cpp plain">,</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">0,</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">0,</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"Main"</code><code class="cpp plain">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="cpp comments">// entry point function name</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"ps_1_1"</code><code class="cpp plain">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="cpp comments">// HLSL shader name </code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">D3DXSHADER_DEBUG,</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">&amp;shader,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="cpp comments">// containing the created shader</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">&amp;errorBuffer,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="cpp comments">// containing a listing of errors and warnings</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">&amp;TextCT);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="cpp comments">// used to access shader constants</code></div><div class="line number19 index18 alt2"><code class="cpp comments">// output any error messages</code></div><div class="line number20 index19 alt1"><code class="cpp keyword bold">if</code><code class="cpp plain">( errorBuffer )</code></div><div class="line number21 index20 alt2"><code class="cpp plain">{</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">::MessageBox(0, (</code><code class="cpp color1 bold">char</code><code class="cpp plain">*)errorBuffer-&gt;GetBufferPointer(), 0, 0);</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">d3d::Release&lt;ID3DXBuffer*&gt;(errorBuffer);</code></div><div class="line number24 index23 alt1"><code class="cpp plain">}</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="cpp keyword bold">if</code> <code class="cpp plain">(FAILED (hr))</code></div><div class="line number27 index26 alt2"><code class="cpp plain">{</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">::MessageBox(0, </code><code class="cpp string">"D3DXCreateEffectFromFile() - FAILED"</code><code class="cpp plain">, 0, 0);</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number30 index29 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;</p><h3><span id="Pixel_Shader"><span style="font-size: 24px;">Pixel Shader(像素着色器) 的输入和输出</span></span></h3><p>&nbsp;</p><p><span style="font-size: 18px;">Pixel Shader 的输入包括颜色和纹理坐标. 都是针对当个像素. 每个像素的纹理坐标其实就是指定了纹理中将被映射到当前像素的纹理元的坐标 (u,v)。. Direct3D 先根据顶点颜色和顶点纹理坐标计算出每个像素的颜色和纹理坐标. 输入像素着色器的颜色和纹理坐标对的个数由顶点着色器输出的颜色和纹理坐标对的个数决定. 例如，如果一个顶点着色器输出两种颜色和3个纹理坐标对， 则Direct3D 将计算出每个像素的两种颜色和3个纹理坐标对，并将这些结果输入像素着色器. 我们需要借助语义语法来将输入的颜色和纹理坐标映射为像素着色器程序中的变量. 我们可以写做如下:</span></p><div><div id="highlighter_409549" class="syntaxhighlighter notranslate cpp"><div class="toolbar"><span><a href="http://www.waitingfy.com/archives/395#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">struct</code> <code class="cpp plain">PS_INPUT</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">vector c0 : COLOR0;</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">vector c1 : COLOR1;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">float2 t0 : TEXCOORD0;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">float2 t1 : TEXCOORD1;</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">float2 t2 : TEXCOORD2;</code></div><div class="line number8 index7 alt1"><code class="cpp plain">};</code></div><div class="line number9 index8 alt2"><code class="cpp plain">For output, a pixel shader outputs a single computed color value </code><code class="cpp keyword bold">for</code> <code class="cpp plain">the pixel:</code></div><div class="line number10 index9 alt1"><code class="cpp keyword bold">struct</code> <code class="cpp plain">PS_OUTPUT</code></div><div class="line number11 index10 alt2"><code class="cpp plain">{</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">vector finalPixelColor : COLOR0;</code></div><div class="line number13 index12 alt2"><code class="cpp plain">};</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;</p><h3><span id="_Pixel_Shader"><span style="font-size: 24px;">使用 Pixel Shader 的步骤</span></span></h3><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><span style="font-size: 18px;">下面列出了要创建和使用Pixel Shader所必须采取的步骤</span></p><p>&nbsp;</p><p><span style="font-size: 18px;">1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 编写 pixel shader.并进行编译。</span></p><p><span style="font-size: 18px;">2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Create an IDirect3DPixelShader9 interface to represent the pixel shader based on the compiled shader code.</span></p><p><span style="font-size: 18px;">3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 用 IDirect3DDevice9::SetPixelShader 方法启用Pixel Shader.</span></p><p>&nbsp;</p><p><span style="font-size: 18px;">当然，当Pixel Shader使用完毕后，我们必须对其进行销毁。下面我们将更详细地解释。</span></p><p>&nbsp;</p><p>&nbsp;</p><h4><span id="Writing_and_Compiling_a_Pixel_Shader"><span style="font-size: 24px;">Writing and Compiling a Pixel Shader</span></span></h4><p><span style="font-size: 18px;">我们用D3DXCompileShaderFromFile 函数来编译Shader.</span></p><p>&nbsp;</p><p>&nbsp;</p><h4><span id="_Pixel_Shader-2"><span style="font-size: 24px;">创建一个 Pixel Shader</span></span></h4><p>&nbsp;</p><p><span style="font-size: 18px;">一旦着色器代码经过了编译，我们就可以借助下述方法获取指向IDirect3DPixelShader9接口的指针, 该接口代表了一个像素着色器。</span></p><div><div id="highlighter_42541" class="syntaxhighlighter notranslate cpp "><div class="toolbar"><span><a href="http://www.waitingfy.com/archives/395#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">HRESULT</code> <code class="cpp plain">IDirect3DDevice9::CreatePixelShader(</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">CONST </code><code class="cpp color1 bold">DWORD</code> <code class="cpp plain">*pFunction,</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">IDirect3DPixelShader9** ppShader</code></div><div class="line number4 index3 alt1"><code class="cpp plain">);</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;</p><p><span style="font-size: 18px;">例如，假定变量shader 是一个 ID3DXBuffer 接口的对象，它包含了经过编译的着色器代码. 为了获取 IDirect3DPixelShader9 接口的指针，我们可以这样做：</span></p><p>&nbsp;</p><p>&nbsp;</p><div><div id="highlighter_519813" class="syntaxhighlighter notranslate cpp"><div class="toolbar"><span><a href="http://www.waitingfy.com/archives/395#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">IDirect3DPixelShader9* MultiTexPS = 0;</code></div><div class="line number2 index1 alt1"><code class="cpp plain">hr = Device-&gt;CreatePixelShader(</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">(</code><code class="cpp color1 bold">DWORD</code><code class="cpp plain">*)shader-&gt;GetBufferPointer(),</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">&amp;MultiTexPS);</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;</p><h4><span id="Setting_a_Pixel_Shader"><span style="font-size: 24px;">Setting a Pixel Shader(像素着色器的设置)</span></span></h4><p><span style="font-size: 18px;">当获取了代表像素着色器的接口IDirect3DPixelShader9的指针后，我们可用下述的方法来将其启用：</span></p><div><div id="highlighter_573278" class="syntaxhighlighter notranslate cpp"><div class="toolbar"><span><a href="http://www.waitingfy.com/archives/395#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">HRESULT</code> <code class="cpp plain">IDirect3DDevice9::SetPixelShader(</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">IDirect3DPixelShader9* pShader</code></div><div class="line number3 index2 alt2"><code class="cpp plain">);</code></div></div></td></tr></tbody></table></div></div><p><span style="font-size: 18px;">该方法只接收一个参数。</span></p><pre>Device-&gt;SetPixelShader(MultiTexPS);</pre><p>&nbsp;</p><h4><span id="Pixel_Shader-2"><span style="font-size: 24px;">Pixel Shader 销毁</span></span></h4><p>&nbsp;</p><p><span style="font-size: 18px;">跟其他 Direct3D 接口一样, 使用完毕之后也必须调用自身的Release方法来释放它所占用的资源。</span></p><p>&nbsp;</p><h2><span id="i-2">应用完整代码</span></h2><div><div id="highlighter_223121" class="syntaxhighlighter notranslate cpp"><div class="toolbar"><span><a href="http://www.waitingfy.com/archives/395#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div><div class="line number105 index104 alt2">105</div><div class="line number106 index105 alt1">106</div><div class="line number107 index106 alt2">107</div><div class="line number108 index107 alt1">108</div><div class="line number109 index108 alt2">109</div><div class="line number110 index109 alt1">110</div><div class="line number111 index110 alt2">111</div><div class="line number112 index111 alt1">112</div><div class="line number113 index112 alt2">113</div><div class="line number114 index113 alt1">114</div><div class="line number115 index114 alt2">115</div><div class="line number116 index115 alt1">116</div><div class="line number117 index116 alt2">117</div><div class="line number118 index117 alt1">118</div><div class="line number119 index118 alt2">119</div><div class="line number120 index119 alt1">120</div><div class="line number121 index120 alt2">121</div><div class="line number122 index121 alt1">122</div><div class="line number123 index122 alt2">123</div><div class="line number124 index123 alt1">124</div><div class="line number125 index124 alt2">125</div><div class="line number126 index125 alt1">126</div><div class="line number127 index126 alt2">127</div><div class="line number128 index127 alt1">128</div><div class="line number129 index128 alt2">129</div><div class="line number130 index129 alt1">130</div><div class="line number131 index130 alt2">131</div><div class="line number132 index131 alt1">132</div><div class="line number133 index132 alt2">133</div><div class="line number134 index133 alt1">134</div><div class="line number135 index134 alt2">135</div><div class="line number136 index135 alt1">136</div><div class="line number137 index136 alt2">137</div><div class="line number138 index137 alt1">138</div><div class="line number139 index138 alt2">139</div><div class="line number140 index139 alt1">140</div><div class="line number141 index140 alt2">141</div><div class="line number142 index141 alt1">142</div><div class="line number143 index142 alt2">143</div><div class="line number144 index143 alt1">144</div><div class="line number145 index144 alt2">145</div><div class="line number146 index145 alt1">146</div><div class="line number147 index146 alt2">147</div><div class="line number148 index147 alt1">148</div><div class="line number149 index148 alt2">149</div><div class="line number150 index149 alt1">150</div><div class="line number151 index150 alt2">151</div><div class="line number152 index151 alt1">152</div><div class="line number153 index152 alt2">153</div><div class="line number154 index153 alt1">154</div><div class="line number155 index154 alt2">155</div><div class="line number156 index155 alt1">156</div><div class="line number157 index156 alt2">157</div><div class="line number158 index157 alt1">158</div><div class="line number159 index158 alt2">159</div><div class="line number160 index159 alt1">160</div><div class="line number161 index160 alt2">161</div><div class="line number162 index161 alt1">162</div><div class="line number163 index162 alt2">163</div><div class="line number164 index163 alt1">164</div><div class="line number165 index164 alt2">165</div><div class="line number166 index165 alt1">166</div><div class="line number167 index166 alt2">167</div><div class="line number168 index167 alt1">168</div><div class="line number169 index168 alt2">169</div><div class="line number170 index169 alt1">170</div><div class="line number171 index170 alt2">171</div><div class="line number172 index171 alt1">172</div><div class="line number173 index172 alt2">173</div><div class="line number174 index173 alt1">174</div><div class="line number175 index174 alt2">175</div><div class="line number176 index175 alt1">176</div><div class="line number177 index176 alt2">177</div><div class="line number178 index177 alt1">178</div><div class="line number179 index178 alt2">179</div><div class="line number180 index179 alt1">180</div><div class="line number181 index180 alt2">181</div><div class="line number182 index181 alt1">182</div><div class="line number183 index182 alt2">183</div><div class="line number184 index183 alt1">184</div><div class="line number185 index184 alt2">185</div><div class="line number186 index185 alt1">186</div><div class="line number187 index186 alt2">187</div><div class="line number188 index187 alt1">188</div><div class="line number189 index188 alt2">189</div><div class="line number190 index189 alt1">190</div><div class="line number191 index190 alt2">191</div><div class="line number192 index191 alt1">192</div><div class="line number193 index192 alt2">193</div><div class="line number194 index193 alt1">194</div><div class="line number195 index194 alt2">195</div><div class="line number196 index195 alt1">196</div><div class="line number197 index196 alt2">197</div><div class="line number198 index197 alt1">198</div><div class="line number199 index198 alt2">199</div><div class="line number200 index199 alt1">200</div><div class="line number201 index200 alt2">201</div><div class="line number202 index201 alt1">202</div><div class="line number203 index202 alt2">203</div><div class="line number204 index203 alt1">204</div><div class="line number205 index204 alt2">205</div><div class="line number206 index205 alt1">206</div><div class="line number207 index206 alt2">207</div><div class="line number208 index207 alt1">208</div><div class="line number209 index208 alt2">209</div><div class="line number210 index209 alt1">210</div><div class="line number211 index210 alt2">211</div><div class="line number212 index211 alt1">212</div><div class="line number213 index212 alt2">213</div><div class="line number214 index213 alt1">214</div><div class="line number215 index214 alt2">215</div><div class="line number216 index215 alt1">216</div><div class="line number217 index216 alt2">217</div><div class="line number218 index217 alt1">218</div><div class="line number219 index218 alt2">219</div><div class="line number220 index219 alt1">220</div><div class="line number221 index220 alt2">221</div><div class="line number222 index221 alt1">222</div><div class="line number223 index222 alt2">223</div><div class="line number224 index223 alt1">224</div><div class="line number225 index224 alt2">225</div><div class="line number226 index225 alt1">226</div><div class="line number227 index226 alt2">227</div><div class="line number228 index227 alt1">228</div><div class="line number229 index228 alt2">229</div><div class="line number230 index229 alt1">230</div><div class="line number231 index230 alt2">231</div><div class="line number232 index231 alt1">232</div><div class="line number233 index232 alt2">233</div><div class="line number234 index233 alt1">234</div><div class="line number235 index234 alt2">235</div><div class="line number236 index235 alt1">236</div><div class="line number237 index236 alt2">237</div><div class="line number238 index237 alt1">238</div><div class="line number239 index238 alt2">239</div><div class="line number240 index239 alt1">240</div><div class="line number241 index240 alt2">241</div><div class="line number242 index241 alt1">242</div><div class="line number243 index242 alt2">243</div><div class="line number244 index243 alt1">244</div><div class="line number245 index244 alt2">245</div><div class="line number246 index245 alt1">246</div><div class="line number247 index246 alt2">247</div><div class="line number248 index247 alt1">248</div><div class="line number249 index248 alt2">249</div><div class="line number250 index249 alt1">250</div><div class="line number251 index250 alt2">251</div><div class="line number252 index251 alt1">252</div><div class="line number253 index252 alt2">253</div><div class="line number254 index253 alt1">254</div><div class="line number255 index254 alt2">255</div><div class="line number256 index255 alt1">256</div><div class="line number257 index256 alt2">257</div><div class="line number258 index257 alt1">258</div><div class="line number259 index258 alt2">259</div><div class="line number260 index259 alt1">260</div><div class="line number261 index260 alt2">261</div><div class="line number262 index261 alt1">262</div><div class="line number263 index262 alt2">263</div><div class="line number264 index263 alt1">264</div><div class="line number265 index264 alt2">265</div><div class="line number266 index265 alt1">266</div><div class="line number267 index266 alt2">267</div><div class="line number268 index267 alt1">268</div><div class="line number269 index268 alt2">269</div><div class="line number270 index269 alt1">270</div><div class="line number271 index270 alt2">271</div><div class="line number272 index271 alt1">272</div><div class="line number273 index272 alt2">273</div><div class="line number274 index273 alt1">274</div><div class="line number275 index274 alt2">275</div><div class="line number276 index275 alt1">276</div><div class="line number277 index276 alt2">277</div><div class="line number278 index277 alt1">278</div><div class="line number279 index278 alt2">279</div><div class="line number280 index279 alt1">280</div><div class="line number281 index280 alt2">281</div><div class="line number282 index281 alt1">282</div><div class="line number283 index282 alt2">283</div><div class="line number284 index283 alt1">284</div><div class="line number285 index284 alt2">285</div><div class="line number286 index285 alt1">286</div><div class="line number287 index286 alt2">287</div><div class="line number288 index287 alt1">288</div><div class="line number289 index288 alt2">289</div><div class="line number290 index289 alt1">290</div><div class="line number291 index290 alt2">291</div><div class="line number292 index291 alt1">292</div><div class="line number293 index292 alt2">293</div><div class="line number294 index293 alt1">294</div><div class="line number295 index294 alt2">295</div><div class="line number296 index295 alt1">296</div><div class="line number297 index296 alt2">297</div><div class="line number298 index297 alt1">298</div><div class="line number299 index298 alt2">299</div><div class="line number300 index299 alt1">300</div><div class="line number301 index300 alt2">301</div><div class="line number302 index301 alt1">302</div><div class="line number303 index302 alt2">303</div><div class="line number304 index303 alt1">304</div><div class="line number305 index304 alt2">305</div><div class="line number306 index305 alt1">306</div><div class="line number307 index306 alt2">307</div><div class="line number308 index307 alt1">308</div><div class="line number309 index308 alt2">309</div><div class="line number310 index309 alt1">310</div><div class="line number311 index310 alt2">311</div><div class="line number312 index311 alt1">312</div><div class="line number313 index312 alt2">313</div><div class="line number314 index313 alt1">314</div><div class="line number315 index314 alt2">315</div><div class="line number316 index315 alt1">316</div><div class="line number317 index316 alt2">317</div><div class="line number318 index317 alt1">318</div><div class="line number319 index318 alt2">319</div><div class="line number320 index319 alt1">320</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">//-----------------------------------------------------------------------------</code></div><div class="line number2 index1 alt1"><code class="cpp comments">// File: Textures.cpp</code></div><div class="line number3 index2 alt2"><code class="cpp comments">// About Using HLSL pixel Shader&nbsp;&nbsp; </code></div><div class="line number4 index3 alt1"><code class="cpp comments">// Copyright (c) Microsoft Corporation &amp; Waitingfy.com. All rights reserved.</code></div><div class="line number5 index4 alt2"><code class="cpp comments">//-----------------------------------------------------------------------------</code></div><div class="line number6 index5 alt1"><code class="cpp preprocessor">#include &lt;Windows.h&gt;</code></div><div class="line number7 index6 alt2"><code class="cpp preprocessor">#include &lt;mmsystem.h&gt;</code></div><div class="line number8 index7 alt1"><code class="cpp preprocessor">#include &lt;d3dx9.h&gt;</code></div><div class="line number9 index8 alt2"><code class="cpp preprocessor">#include &lt;strsafe.h&gt;</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="cpp comments">//-----------------------------------------------------------------------------</code></div><div class="line number14 index13 alt1"><code class="cpp comments">// Global variables</code></div><div class="line number15 index14 alt2"><code class="cpp comments">//-----------------------------------------------------------------------------</code></div><div class="line number16 index15 alt1"><code class="cpp plain">LPDIRECT3D9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; g_pD3D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = NULL; </code><code class="cpp comments">// Used to create the D3DDevice</code></div><div class="line number17 index16 alt2"><code class="cpp plain">LPDIRECT3DDEVICE9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; g_pd3dDevice = NULL; </code><code class="cpp comments">// Our rendering device</code></div><div class="line number18 index17 alt1"><code class="cpp plain">LPDIRECT3DVERTEXBUFFER9 g_pVB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = NULL; </code><code class="cpp comments">// Buffer to hold vertices</code></div><div class="line number19 index18 alt2"><code class="cpp plain">LPDIRECT3DTEXTURE9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; g_pTexture&nbsp;&nbsp; = NULL; </code><code class="cpp comments">// Our texture</code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2"><code class="cpp plain">IDirect3DPixelShader9* TexPS = 0;</code></div><div class="line number22 index21 alt1"><code class="cpp plain">ID3DXConstantTable* TextCT = 0;</code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1"><code class="cpp plain">D3DXHANDLE BaseTexHandle = 0;</code></div><div class="line number25 index24 alt2"><code class="cpp plain">D3DXCONSTANT_DESC BaseTexDesc;</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="cpp comments">// A structure for our custom vertex type. We added texture coordinates</code></div><div class="line number28 index27 alt1"><code class="cpp keyword bold">struct</code> <code class="cpp plain">CUSTOMVERTEX</code></div><div class="line number29 index28 alt2"><code class="cpp plain">{</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">float</code> <code class="cpp plain">x, y, z;</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">long</code> <code class="cpp plain">color;</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">FLOAT</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="cpp plain">tu, tv;&nbsp;&nbsp; </code><code class="cpp comments">// 纹理坐标</code></div><div class="line number33 index32 alt2"><code class="cpp plain">};</code></div><div class="line number34 index33 alt1">&nbsp;</div><div class="line number35 index34 alt2"><code class="cpp comments">// 多了纹理，增加了D3DFVF_TEX1</code></div><div class="line number36 index35 alt1"><code class="cpp preprocessor">#define D3DFVF_CUSTOMVERTEX (D3DFVF_XYZ|D3DFVF_DIFFUSE|D3DFVF_TEX1)</code></div><div class="line number37 index36 alt2">&nbsp;</div><div class="line number38 index37 alt1">&nbsp;</div><div class="line number39 index38 alt2"><code class="cpp comments">//-----------------------------------------------------------------------------</code></div><div class="line number40 index39 alt1"><code class="cpp comments">// Name: InitD3D()</code></div><div class="line number41 index40 alt2"><code class="cpp comments">// Desc: Initializes Direct3D</code></div><div class="line number42 index41 alt1"><code class="cpp comments">//-----------------------------------------------------------------------------</code></div><div class="line number43 index42 alt2"><code class="cpp color1 bold">HRESULT</code> <code class="cpp plain">InitD3D( </code><code class="cpp color1 bold">HWND</code> <code class="cpp plain">hWnd )</code></div><div class="line number44 index43 alt1"><code class="cpp plain">{</code></div><div class="line number45 index44 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Create the D3D object.</code></div><div class="line number46 index45 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">( NULL == ( g_pD3D = Direct3DCreate9( D3D_SDK_VERSION ) ) )</code></div><div class="line number47 index46 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">E_FAIL;</code></div><div class="line number48 index47 alt1">&nbsp;</div><div class="line number49 index48 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Set up the structure used to create the D3DDevice. Since we are now</code></div><div class="line number50 index49 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// using more complex geometry, we will create a device with a zbuffer.</code></div><div class="line number51 index50 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">D3DPRESENT_PARAMETERS d3dpp;</code></div><div class="line number52 index51 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ZeroMemory( &amp;d3dpp, </code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(d3dpp) );</code></div><div class="line number53 index52 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">d3dpp.Windowed = TRUE;</code></div><div class="line number54 index53 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">d3dpp.SwapEffect = D3DSWAPEFFECT_DISCARD;</code></div><div class="line number55 index54 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">d3dpp.BackBufferFormat = D3DFMT_UNKNOWN;</code></div><div class="line number56 index55 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">d3dpp.EnableAutoDepthStencil = TRUE;</code></div><div class="line number57 index56 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">d3dpp.AutoDepthStencilFormat = D3DFMT_D16;</code></div><div class="line number58 index57 alt1">&nbsp;</div><div class="line number59 index58 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Create the D3DDevice</code></div><div class="line number60 index59 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">( FAILED( g_pD3D-&gt;CreateDevice( D3DADAPTER_DEFAULT, D3DDEVTYPE_HAL, hWnd,</code></div><div class="line number61 index60 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">D3DCREATE_SOFTWARE_VERTEXPROCESSING,</code></div><div class="line number62 index61 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">&amp;d3dpp, &amp;g_pd3dDevice ) ) )</code></div><div class="line number63 index62 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number64 index63 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">E_FAIL;</code></div><div class="line number65 index64 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number66 index65 alt1">&nbsp;</div><div class="line number67 index66 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Turn off culling</code></div><div class="line number68 index67 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pd3dDevice-&gt;SetRenderState( D3DRS_CULLMODE, D3DCULL_NONE );</code></div><div class="line number69 index68 alt2">&nbsp;</div><div class="line number70 index69 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Turn off D3D lighting</code></div><div class="line number71 index70 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pd3dDevice-&gt;SetRenderState( D3DRS_LIGHTING, FALSE );</code></div><div class="line number72 index71 alt1">&nbsp;</div><div class="line number73 index72 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Turn on the zbuffer</code></div><div class="line number74 index73 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pd3dDevice-&gt;SetRenderState( D3DRS_ZENABLE, TRUE );</code></div><div class="line number75 index74 alt2">&nbsp;</div><div class="line number76 index75 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">HRESULT</code> <code class="cpp plain">hr = 0;</code></div><div class="line number77 index76 alt2">&nbsp;</div><div class="line number78 index77 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ID3DXBuffer* shader = 0;</code></div><div class="line number79 index78 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ID3DXBuffer* errorBuffer = 0;</code></div><div class="line number80 index79 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//从文件名中编译shader</code></div><div class="line number81 index80 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">hr = D3DXCompileShaderFromFile(</code><code class="cpp string">"hlslTexture.txt"</code><code class="cpp plain">,</code></div><div class="line number82 index81 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">0,</code></div><div class="line number83 index82 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">0,</code></div><div class="line number84 index83 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"Main"</code><code class="cpp plain">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="cpp comments">//入口名称</code></div><div class="line number85 index84 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"ps_1_1"</code><code class="cpp plain">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="cpp comments">//shader版本</code></div><div class="line number86 index85 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">D3DXSHADER_DEBUG,</code></div><div class="line number87 index86 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">&amp;shader,</code></div><div class="line number88 index87 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">&amp;errorBuffer,&nbsp; </code><code class="cpp comments">//包含错误和警告信息</code></div><div class="line number89 index88 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">&amp;TextCT);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="cpp comments">//访问shader constants</code></div><div class="line number90 index89 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(errorBuffer)</code></div><div class="line number91 index90 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number92 index91 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">::MessageBox(0,(</code><code class="cpp color1 bold">char</code><code class="cpp plain">*)errorBuffer-&gt;GetBufferPointer(), 0, 0);</code></div><div class="line number93 index92 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">errorBuffer-&gt;Release();</code></div><div class="line number94 index93 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number95 index94 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(FAILED(hr))</code></div><div class="line number96 index95 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number97 index96 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">::MessageBox(0,</code><code class="cpp string">"D3DXCompileShaderFromFile() - FAILED"</code><code class="cpp plain">, 0, 0);</code></div><div class="line number98 index97 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number99 index98 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number100 index99 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number101 index100 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">hr = g_pd3dDevice-&gt;CreatePixelShader((</code><code class="cpp color1 bold">DWORD</code><code class="cpp plain">*)shader-&gt;GetBufferPointer(),&amp;TexPS);</code></div><div class="line number102 index101 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(FAILED(hr))</code></div><div class="line number103 index102 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number104 index103 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">::MessageBox(0,</code><code class="cpp string">"CreateVertexShader - FAILED"</code><code class="cpp plain">, 0, 0);</code></div><div class="line number105 index104 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number106 index105 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number107 index106 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">shader-&gt;Release();</code></div><div class="line number108 index107 alt1">&nbsp;</div><div class="line number109 index108 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// 得到一个 constant </code></div><div class="line number110 index109 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">BaseTexHandle = TextCT-&gt;GetConstantByName(0, </code><code class="cpp string">"BaseTex"</code><code class="cpp plain">);</code></div><div class="line number111 index110 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number112 index111 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">UINT</code> <code class="cpp plain">count;</code></div><div class="line number113 index112 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number114 index113 alt1">&nbsp;</div><div class="line number115 index114 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// 设置 constant descriptions</code></div><div class="line number116 index115 alt1">&nbsp;</div><div class="line number117 index116 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">TextCT-&gt;GetConstantDesc(BaseTexHandle, &amp;BaseTexDesc, &amp;count);</code></div><div class="line number118 index117 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">S_OK;</code></div><div class="line number119 index118 alt2"><code class="cpp plain">}</code></div><div class="line number120 index119 alt1">&nbsp;</div><div class="line number121 index120 alt2">&nbsp;</div><div class="line number122 index121 alt1"><code class="cpp comments">//-----------------------------------------------------------------------------</code></div><div class="line number123 index122 alt2"><code class="cpp comments">// Name: InitGeometry()</code></div><div class="line number124 index123 alt1"><code class="cpp comments">// Desc: Create the Textures and vertex buffers</code></div><div class="line number125 index124 alt2"><code class="cpp comments">//-----------------------------------------------------------------------------</code></div><div class="line number126 index125 alt1"><code class="cpp color1 bold">HRESULT</code> <code class="cpp plain">InitGeometry()</code></div><div class="line number127 index126 alt2"><code class="cpp plain">{</code></div><div class="line number128 index127 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">HRESULT</code> <code class="cpp plain">hr = 0;</code></div><div class="line number129 index128 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// 创建纹理</code></div><div class="line number130 index129 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">hr = D3DXCreateTextureFromFile( g_pd3dDevice, </code><code class="cpp string">"objective-c.png"</code><code class="cpp plain">, &amp;g_pTexture );</code></div><div class="line number131 index130 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(FAILED(hr))</code></div><div class="line number132 index131 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number133 index132 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">MessageBox(NULL, </code><code class="cpp string">"Could not find objective-c.png"</code><code class="cpp plain">, </code><code class="cpp string">"Textures.exe"</code><code class="cpp plain">, MB_OK);</code></div><div class="line number134 index133 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">E_FAIL;&nbsp;&nbsp; </code></div><div class="line number135 index134 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number136 index135 alt1">&nbsp;</div><div class="line number137 index136 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// 构造组成物体的顶点，并为其指定纹理坐标</code></div><div class="line number138 index137 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">CUSTOMVERTEX Vertices[] =</code></div><div class="line number139 index138 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number140 index139 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{ -1.0f, -1.0f, 0.0f, D3DCOLOR_XRGB(255,255,255),0,1 }, </code><code class="cpp comments">// x, y, z, rhw, color,tu,tv</code></div><div class="line number141 index140 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{ -1.0f, 1.0f, 0.0f, D3DCOLOR_XRGB(255,255,255), 0,0},</code></div><div class="line number142 index141 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{ 1.0f, -1.0f, 0.0f, D3DCOLOR_XRGB(255,255,255), 1,1},</code></div><div class="line number143 index142 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{ 1.0f, 1.0f, 0.0f, D3DCOLOR_XRGB(255,255,255), 1,0},</code></div><div class="line number144 index143 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">};</code></div><div class="line number145 index144 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Create the vertex buffer.</code></div><div class="line number146 index145 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">hr = g_pd3dDevice-&gt;CreateVertexBuffer(</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(Vertices),</code></div><div class="line number147 index146 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">D3DUSAGE_WRITEONLY,D3DFVF_CUSTOMVERTEX,</code></div><div class="line number148 index147 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">D3DPOOL_MANAGED,&amp;g_pVB,0);</code></div><div class="line number149 index148 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(hr)</code></div><div class="line number150 index149 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number151 index150 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">E_FAIL;</code></div><div class="line number152 index151 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number153 index152 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">VOID</code><code class="cpp plain">* pVertices;</code></div><div class="line number154 index153 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">( FAILED( g_pVB-&gt;Lock( 0, </code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(Vertices), (</code><code class="cpp keyword bold">void</code><code class="cpp plain">**)&amp;pVertices, 0 ) ) )</code></div><div class="line number155 index154 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">E_FAIL;</code></div><div class="line number156 index155 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">memcpy</code><code class="cpp plain">( pVertices, Vertices, </code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(Vertices) );</code></div><div class="line number157 index156 alt2">&nbsp;</div><div class="line number158 index157 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pVB-&gt;Unlock();</code></div><div class="line number159 index158 alt2">&nbsp;</div><div class="line number160 index159 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">S_OK;</code></div><div class="line number161 index160 alt2"><code class="cpp plain">}</code></div><div class="line number162 index161 alt1">&nbsp;</div><div class="line number163 index162 alt2">&nbsp;</div><div class="line number164 index163 alt1"><code class="cpp comments">//-----------------------------------------------------------------------------</code></div><div class="line number165 index164 alt2"><code class="cpp comments">// Name: Cleanup()</code></div><div class="line number166 index165 alt1"><code class="cpp comments">// Desc: Releases all previously initialized objects</code></div><div class="line number167 index166 alt2"><code class="cpp comments">//-----------------------------------------------------------------------------</code></div><div class="line number168 index167 alt1"><code class="cpp color1 bold">VOID</code> <code class="cpp plain">Cleanup()</code></div><div class="line number169 index168 alt2"><code class="cpp plain">{</code></div><div class="line number170 index169 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">( g_pTexture != NULL )</code></div><div class="line number171 index170 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pTexture-&gt;Release();</code></div><div class="line number172 index171 alt1">&nbsp;</div><div class="line number173 index172 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">( g_pVB != NULL )</code></div><div class="line number174 index173 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pVB-&gt;Release();</code></div><div class="line number175 index174 alt2">&nbsp;</div><div class="line number176 index175 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">( g_pd3dDevice != NULL )</code></div><div class="line number177 index176 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pd3dDevice-&gt;Release();</code></div><div class="line number178 index177 alt1">&nbsp;</div><div class="line number179 index178 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">( g_pD3D != NULL )</code></div><div class="line number180 index179 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pD3D-&gt;Release();</code></div><div class="line number181 index180 alt2">&nbsp;</div><div class="line number182 index181 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(TexPS != NULL )</code></div><div class="line number183 index182 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">TexPS-&gt;Release();</code></div><div class="line number184 index183 alt1">&nbsp;</div><div class="line number185 index184 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(TextCT != NULL)</code></div><div class="line number186 index185 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">TextCT-&gt;Release();</code></div><div class="line number187 index186 alt2"><code class="cpp plain">}</code></div><div class="line number188 index187 alt1">&nbsp;</div><div class="line number189 index188 alt2"><code class="cpp comments">//-----------------------------------------------------------------------------</code></div><div class="line number190 index189 alt1"><code class="cpp comments">// Name: SetupMatrices()</code></div><div class="line number191 index190 alt2"><code class="cpp comments">// Desc: Sets up the world, view, and projection transform matrices.</code></div><div class="line number192 index191 alt1"><code class="cpp comments">//-----------------------------------------------------------------------------</code></div><div class="line number193 index192 alt2"><code class="cpp color1 bold">VOID</code> <code class="cpp plain">SetupMatrices()</code></div><div class="line number194 index193 alt1"><code class="cpp plain">{</code></div><div class="line number195 index194 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// 一定时间绕Y轴旋转</code></div><div class="line number196 index195 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">D3DXMATRIXA16 matWorld;</code></div><div class="line number197 index196 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">D3DXMatrixIdentity( &amp;matWorld );</code></div><div class="line number198 index197 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//移除下面的注释即可旋转</code></div><div class="line number199 index198 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//D3DXMatrixRotationY( &amp;matWorld, timeGetTime()/1000.0f );</code></div><div class="line number200 index199 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pd3dDevice-&gt;SetTransform( D3DTS_WORLD, &amp;matWorld );</code></div><div class="line number201 index200 alt2">&nbsp;</div><div class="line number202 index201 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// 设置摄像头的位置等</code></div><div class="line number203 index202 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">D3DXVECTOR3 vEyePt( 0.0f, 0.0f,-2.5f );</code></div><div class="line number204 index203 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">D3DXVECTOR3 vLookatPt( 0.0f, 0.0f, 0.0f );</code></div><div class="line number205 index204 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">D3DXVECTOR3 vUpVec( 0.0f, 1.0f, 0.0f );</code></div><div class="line number206 index205 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">D3DXMATRIXA16 matView;</code></div><div class="line number207 index206 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">D3DXMatrixLookAtLH( &amp;matView, &amp;vEyePt, &amp;vLookatPt, &amp;vUpVec );</code></div><div class="line number208 index207 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pd3dDevice-&gt;SetTransform( D3DTS_VIEW, &amp;matView );</code></div><div class="line number209 index208 alt2">&nbsp;</div><div class="line number210 index209 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// 设置视锥体</code></div><div class="line number211 index210 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">D3DXMATRIXA16 matProj;</code></div><div class="line number212 index211 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">D3DXMatrixPerspectiveFovLH( &amp;matProj, D3DX_PI/4, 1.0f, 1.0f, 100.0f );</code></div><div class="line number213 index212 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pd3dDevice-&gt;SetTransform( D3DTS_PROJECTION, &amp;matProj );</code></div><div class="line number214 index213 alt1">&nbsp;</div><div class="line number215 index214 alt2"><code class="cpp plain">}</code></div><div class="line number216 index215 alt1">&nbsp;</div><div class="line number217 index216 alt2">&nbsp;</div><div class="line number218 index217 alt1"><code class="cpp comments">//-----------------------------------------------------------------------------</code></div><div class="line number219 index218 alt2"><code class="cpp comments">// Name: Render()</code></div><div class="line number220 index219 alt1"><code class="cpp comments">// Desc: Draws the scene</code></div><div class="line number221 index220 alt2"><code class="cpp comments">//-----------------------------------------------------------------------------</code></div><div class="line number222 index221 alt1"><code class="cpp color1 bold">VOID</code> <code class="cpp plain">Render()</code></div><div class="line number223 index222 alt2"><code class="cpp plain">{</code></div><div class="line number224 index223 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Clear the backbuffer and the zbuffer</code></div><div class="line number225 index224 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pd3dDevice-&gt;Clear( 0, NULL, D3DCLEAR_TARGET|D3DCLEAR_ZBUFFER,</code></div><div class="line number226 index225 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">D3DCOLOR_XRGB(0,0,255), 1.0f, 0 );</code></div><div class="line number227 index226 alt2">&nbsp;</div><div class="line number228 index227 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Begin the scene</code></div><div class="line number229 index228 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">( SUCCEEDED( g_pd3dDevice-&gt;BeginScene() ) )</code></div><div class="line number230 index229 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number231 index230 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Setup the world, view, and projection matrices</code></div><div class="line number232 index231 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">SetupMatrices();</code></div><div class="line number233 index232 alt2">&nbsp;</div><div class="line number234 index233 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pd3dDevice-&gt;SetPixelShader(TexPS);</code></div><div class="line number235 index234 alt2">&nbsp;</div><div class="line number236 index235 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// 绘制物体前，设置物体关联的纹理</code></div><div class="line number237 index236 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pd3dDevice-&gt;SetTexture(BaseTexDesc.RegisterIndex, g_pTexture);</code></div><div class="line number238 index237 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pd3dDevice-&gt;SetSamplerState(BaseTexDesc.RegisterIndex, D3DSAMP_MAGFILTER, D3DTEXF_LINEAR);</code></div><div class="line number239 index238 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pd3dDevice-&gt;SetSamplerState(BaseTexDesc.RegisterIndex, D3DSAMP_MINFILTER, D3DTEXF_LINEAR);</code></div><div class="line number240 index239 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pd3dDevice-&gt;SetSamplerState(BaseTexDesc.RegisterIndex, D3DSAMP_MIPFILTER, D3DTEXF_LINEAR);</code></div><div class="line number241 index240 alt2">&nbsp;</div><div class="line number242 index241 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Render the vertex buffer contents</code></div><div class="line number243 index242 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pd3dDevice-&gt;SetStreamSource( 0, g_pVB, 0, </code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(CUSTOMVERTEX) );</code></div><div class="line number244 index243 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pd3dDevice-&gt;SetFVF( D3DFVF_CUSTOMVERTEX );</code></div><div class="line number245 index244 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//两个三角形组成矩形</code></div><div class="line number246 index245 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pd3dDevice-&gt;DrawPrimitive( D3DPT_TRIANGLESTRIP, 0, 2);</code></div><div class="line number247 index246 alt2">&nbsp;</div><div class="line number248 index247 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// End the scene</code></div><div class="line number249 index248 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pd3dDevice-&gt;EndScene();</code></div><div class="line number250 index249 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number251 index250 alt2">&nbsp;</div><div class="line number252 index251 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Present the backbuffer contents to the display</code></div><div class="line number253 index252 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">g_pd3dDevice-&gt;Present( NULL, NULL, NULL, NULL );</code></div><div class="line number254 index253 alt1"><code class="cpp plain">}</code></div><div class="line number255 index254 alt2">&nbsp;</div><div class="line number256 index255 alt1">&nbsp;</div><div class="line number257 index256 alt2"><code class="cpp comments">//-----------------------------------------------------------------------------</code></div><div class="line number258 index257 alt1"><code class="cpp comments">// Name: MsgProc()</code></div><div class="line number259 index258 alt2"><code class="cpp comments">// Desc: The window's message handler</code></div><div class="line number260 index259 alt1"><code class="cpp comments">//-----------------------------------------------------------------------------</code></div><div class="line number261 index260 alt2"><code class="cpp color1 bold">LRESULT</code> <code class="cpp plain">WINAPI MsgProc( </code><code class="cpp color1 bold">HWND</code> <code class="cpp plain">hWnd, </code><code class="cpp color1 bold">UINT</code> <code class="cpp plain">msg, </code><code class="cpp color1 bold">WPARAM</code> <code class="cpp plain">wParam, </code><code class="cpp color1 bold">LPARAM</code> <code class="cpp plain">lParam )</code></div><div class="line number262 index261 alt1"><code class="cpp plain">{</code></div><div class="line number263 index262 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">switch</code><code class="cpp plain">( msg )</code></div><div class="line number264 index263 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number265 index264 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code> <code class="cpp plain">WM_DESTROY:</code></div><div class="line number266 index265 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Cleanup();</code></div><div class="line number267 index266 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">PostQuitMessage( 0 );</code></div><div class="line number268 index267 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">0;</code></div><div class="line number269 index268 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number270 index269 alt1">&nbsp;</div><div class="line number271 index270 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">DefWindowProc( hWnd, msg, wParam, lParam );</code></div><div class="line number272 index271 alt1"><code class="cpp plain">}</code></div><div class="line number273 index272 alt2">&nbsp;</div><div class="line number274 index273 alt1">&nbsp;</div><div class="line number275 index274 alt2"><code class="cpp comments">//-----------------------------------------------------------------------------</code></div><div class="line number276 index275 alt1"><code class="cpp comments">// Name: WinMain()</code></div><div class="line number277 index276 alt2"><code class="cpp comments">// Desc: The application's entry point</code></div><div class="line number278 index277 alt1"><code class="cpp comments">//-----------------------------------------------------------------------------</code></div><div class="line number279 index278 alt2"><code class="cpp color1 bold">INT</code> <code class="cpp plain">WINAPI WinMain( </code><code class="cpp color1 bold">HINSTANCE</code> <code class="cpp plain">hInst, </code><code class="cpp color1 bold">HINSTANCE</code><code class="cpp plain">, </code><code class="cpp color1 bold">LPSTR</code><code class="cpp plain">, </code><code class="cpp color1 bold">INT</code> <code class="cpp plain">)</code></div><div class="line number280 index279 alt1"><code class="cpp plain">{</code></div><div class="line number281 index280 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Register the window class</code></div><div class="line number282 index281 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">WNDCLASSEX wc = { </code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(WNDCLASSEX), CS_CLASSDC, MsgProc, 0L, 0L,</code></div><div class="line number283 index282 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">GetModuleHandle(NULL), NULL, NULL, NULL, NULL,</code></div><div class="line number284 index283 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp string">"D3D Tutorial"</code><code class="cpp plain">, NULL };</code></div><div class="line number285 index284 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">RegisterClassEx( &amp;wc );</code></div><div class="line number286 index285 alt1">&nbsp;</div><div class="line number287 index286 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Create the application's window</code></div><div class="line number288 index287 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">HWND</code> <code class="cpp plain">hWnd = CreateWindow( </code><code class="cpp string">"D3D Tutorial"</code><code class="cpp plain">, </code><code class="cpp string">"D3D Tutorial 05: Textures"</code><code class="cpp plain">,</code></div><div class="line number289 index288 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">WS_OVERLAPPEDWINDOW, 100, 100, 300, 300,</code></div><div class="line number290 index289 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">GetDesktopWindow(), NULL, wc.hInstance, NULL );</code></div><div class="line number291 index290 alt2">&nbsp;</div><div class="line number292 index291 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Initialize Direct3D</code></div><div class="line number293 index292 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">( SUCCEEDED( InitD3D( hWnd ) ) )</code></div><div class="line number294 index293 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number295 index294 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Create the scene geometry</code></div><div class="line number296 index295 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">( SUCCEEDED( InitGeometry() ) )</code></div><div class="line number297 index296 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number298 index297 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Show the window</code></div><div class="line number299 index298 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ShowWindow( hWnd, SW_SHOWDEFAULT );</code></div><div class="line number300 index299 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">UpdateWindow( hWnd );</code></div><div class="line number301 index300 alt2">&nbsp;</div><div class="line number302 index301 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">// Enter the message loop</code></div><div class="line number303 index302 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">MSG msg;</code></div><div class="line number304 index303 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ZeroMemory( &amp;msg, </code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(msg) );</code></div><div class="line number305 index304 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code><code class="cpp plain">( msg.message!=WM_QUIT )</code></div><div class="line number306 index305 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number307 index306 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">( PeekMessage( &amp;msg, NULL, 0U, 0U, PM_REMOVE ) )</code></div><div class="line number308 index307 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number309 index308 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">TranslateMessage( &amp;msg );</code></div><div class="line number310 index309 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">DispatchMessage( &amp;msg );</code></div><div class="line number311 index310 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number312 index311 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code></div><div class="line number313 index312 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Render();</code></div><div class="line number314 index313 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number315 index314 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number316 index315 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number317 index316 alt2">&nbsp;</div><div class="line number318 index317 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">UnregisterClass( </code><code class="cpp string">"D3D Tutorial"</code><code class="cpp plain">, wc.hInstance );</code></div><div class="line number319 index318 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code> <code class="cpp plain">0;</code></div><div class="line number320 index319 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;</p><p>&nbsp;</p><p><span style="font-size: 18px;">引用:</span></p><p><span style="font-size: 18px;">1. &lt;<span class="b24-booktitle">Introduction to 3D Game Programming with DirectX 9.0</span>&gt;<span class="chapter-titlelabel"> Chapter 16:</span>Introduction to the High-Level Shading Language,<span class="chapter-titlelabel">Chapter 18:</span>Introduction to Pixel Shaders</span></p><p>&nbsp;</p><p><span style="font-size: 18px;"><span class="b24-booktitle">2. DirectX 9.0</span> SDK’s Tutorial 5: Using Texture Maps</span></p><p>&nbsp;</p><p><span style="font-size: 18px;">3. HLSL初步知识讲解 <a href="http://download.csdn.net/detail/chengscga/3948392" target="_blank">http://download.csdn.net/detail/chengscga/3948392</a></span></p><p>&nbsp;</p><p>&nbsp;</p><p>项目下载:</p><p><a title="下载" href="http://download.csdn.net/detail/fox64194167/5025633">http://download.csdn.net/detail/fox64194167/5025633</a>&nbsp;(CSDN 免积分，有中文注释。)</p><p><a href="http://www.waitingfy.com/wp-content/uploads/2013/02/HLSL+Pixel+Shader-Chinese.rar">HLSL+Pixel+Shader</a> (www.Waitingfy.com Download)</p><p>&nbsp;</p><p><a title=" Illustrate a HLSL example by using Pixel Shade" href="http://www.waitingfy.com/?p=387" target="_blank">&nbsp;</a><a title="用一个Pixel Shader(像素着色器)来介绍HLSL" href="http://www.waitingfy.com/?p=395">http://www.waitingfy.com/?p=395</a></p><div class="post-views post-395 entry-meta"> <span class="post-views-icon dashicons dashicons-chart-bar"></span> <span class="post-views-label">Post Views: </span> <span class="post-views-count">29</span></div><div class="rp4wp-related-posts"><h3><span id="Related_Posts">Related Posts</span></h3><ul><li><div class="rp4wp-related-post-content"> <a href="http://www.waitingfy.com/archives/1741">cocos2d 3.X Shader 变暗和变灰</a><p>cocos2d 3.X Sha…</p></div></li><li><div class="rp4wp-related-post-content"> <a href="http://www.waitingfy.com/archives/1318">cocos2d 简单高仿天天跑酷游戏</a><p>我们来看下简单的跑酷游戏实现的…</p></div></li><li><div class="rp4wp-related-post-content"> <a href="http://www.waitingfy.com/archives/783">Cocos2d-x 酷跑游戏例子</a><p>cocos2d-x 中菜单的使…</p></div></li><li><div class="rp4wp-related-post-content"> <a href="http://www.waitingfy.com/archives/1818">Python 用BeautifulSoup 解析Html</a><p>用BeautifulSoup …</p></div></li><li><div class="rp4wp-related-post-content"> <a href="http://www.waitingfy.com/archives/831">Cocos2d-x 寻路算法之二 离目的地的距离优先</a><p>我们发现之前寻路算法有点傻，明…</p></div></li></ul></div> 395<p class="postmetadata alt"> <small> <span class="tiny-category"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/directx" rel="category tag">DirectX</a></span> | <a href="http://www.waitingfy.com/archives/395/feed"><span class="tiny-rss">RSS 2.0</span></a> | <a href="http://www.waitingfy.com/archives/395#respond" class="tiny-comments">Respond</a> | <a href="http://www.waitingfy.com/archives/395/trackback" rel="trackback" class="tiny-trackback">Trackback</a> | </small></p></div><div id="bottom_myself_ad"> <img src="./DX9 使用 Shader教程_files/wxdyh1.jpg"></div></div><div id="comment_container" style="width:840px;"><div id="comment_left" style="width:450px;float:left;"><div class="posttitle"><h3 id="comments">One Response to 用一个Pixel Shader(像素着色器)来介绍HLSL</h3></div><div class="post"><div class="comment-navigation"><div class="alignleft"></div><div class="alignright"></div></div><ol class="commentlist"><li class="trackback even thread-even depth-1" id="comment-105"><div id="div-comment-105" class="comment-body"><div class="comment-author vcard"> <cite class="fn"><a href="http://www.carrieraircon.co.uk/index.php/member/23110/" rel="external nofollow" class="url">mouse click the next webpage</a></cite><span class="says">说道：</span></div><div class="comment-meta commentmetadata"><a href="http://www.waitingfy.com/archives/395#comment-105"> 2013年3月4日 上午6:57</a></div><p><strong>mouse click the next webpage…</strong></p><p>Waiting For You » Blog Archive » ç¨ä¸ä¸ªPixel Shader(åç´&nbsp;çè²å¨)æ¥ä»ç»HLSL…</p><div class="reply"><a rel="nofollow" class="comment-reply-link" href="http://www.waitingfy.com/archives/395?replytocom=105#respond" onclick="return addComment.moveForm( &quot;div-comment-105&quot;, &quot;105&quot;, &quot;respond&quot;, &quot;395&quot; )" aria-label="回复给mouse click the next webpage">回复</a></div></div></li></ol><div class="comment-navigation"><div class="alignleft"></div><div class="alignright"></div></div></div><div style="width:840px;"><div id="postitleAndPost" style="width:450px;float:left;"><div class="posttitle"><h3>Leave a Reply</h3></div><div class="post"><div class="cancel-comment-reply"> <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://www.waitingfy.com/archives/395#respond" style="display:none;">点击这里取消回复。</a></small></div><form action="http://www.waitingfy.com/wp-comments-post.php" method="post" id="commentform"><p class="firstresponse">Name and Email Address are required fields.<br> Your email will not be published or shared with third parties.</p><p><label for="author">Name *</label><input type="text" name="author" id="author" value="" size="22" tabindex="1" aria-required="true"></p><p><label for="email">Email Address *</label><input type="text" name="email" id="email" value="" size="22" tabindex="2" aria-required="true"></p><p><label for="url">Website</label><input type="text" name="url" id="url" value="" size="22" tabindex="3"></p><p><textarea name="comment" id="comment" cols="100%" rows="10" tabindex="4"></textarea></p><p><input name="submit" type="submit" id="submit" tabindex="5" value="评论"> <input type="hidden" name="comment_post_ID" value="395" id="comment_post_ID"> <input type="hidden" name="comment_parent" id="comment_parent" value="0"></p><p class="antispam-group antispam-group-q" style="clear: both;"> <label>Current ye@r <span class="required">*</span></label> <input type="hidden" name="antspm-a" class="antispam-control antispam-control-a" value="2019"> <input type="text" name="antspm-q" class="antispam-control antispam-control-q" value="5.5" autocomplete="off"></p><p class="antispam-group antispam-group-e" style="display: none;"> <label>Leave this field empty</label> <input type="text" name="antspm-e-email-url-website" class="antispam-control antispam-control-e" value="" autocomplete="off"></p></form></div></div><div id="commentAd" style="width:336px;float:left;margin-left:50px;"> <script type="text/javascript">google_ad_client = "ca-pub-0295086493266141";
/* adminAdLeft */
google_ad_slot = "1565837638";
google_ad_width = 336;
google_ad_height = 280;</script> <script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script> </div></div><div class="clear"></div></div><div id="comment_right" style="width:336px;float:left;margin-left:50px;"> <script type="text/javascript">google_ad_client = "ca-pub-0295086493266141";
/* adminAdLeft */
google_ad_slot = "1565837638";
google_ad_width = 336;
google_ad_height = 280;</script> <script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script> </div></div><div class="clear"></div></div></div><div id="sidebar" class="sides"><ul><li><form method="get" id="searchform" action="http://www.waitingfy.com/"><div><input type="text" value="" name="s" id="s"> <input type="submit" id="searchsubmit" value="Find"></div></form></li><li>分类目录<ul><li class="cat-item cat-item-109"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/%e3%80%8a%e6%b7%b1%e5%85%a5%e6%b5%85%e5%87%ba%e7%bb%9f%e8%ae%a1%e5%ad%a6%e3%80%8b">《深入浅出统计学》</a></li><li class="cat-item cat-item-15"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/3d%e4%b8%ad%e7%9a%84%e6%95%b0%e5%ad%a6%e5%9f%ba%e7%a1%80">3D中的数学基础</a></li><li class="cat-item cat-item-4"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/android-2d-%e6%b8%b8%e6%88%8f%e5%bc%80%e5%8f%91">Android 2D 游戏开发</a></li><li class="cat-item cat-item-3"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/android-%e4%b8%ad%e4%bd%bf%e7%94%a8opengl-es%e8%bf%9b%e8%a1%8c2d%e5%bc%80%e5%8f%91">Android 中使用OpenGL ES进行2D开发</a></li><li class="cat-item cat-item-2"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/android-%e8%bd%af%e4%bb%b6%e5%bc%80%e5%8f%91">Android 软件开发</a></li><li class="cat-item cat-item-18"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/boost">boost</a></li><li class="cat-item cat-item-14"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/c%e5%9f%ba%e7%a1%80">C++基础</a></li><li class="cat-item cat-item-34"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/cocos2d-html5">cocos2d html5</a></li><li class="cat-item cat-item-68"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/cocos2d-lua">cocos2d lua</a></li><li class="cat-item cat-item-17"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/cocos2d-x">cocos2d-x</a></li><li class="cat-item cat-item-11"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/directx">DirectX</a></li><li class="cat-item cat-item-110"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/django">django</a></li><li class="cat-item cat-item-79"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/docker">docker</a></li><li class="cat-item cat-item-98"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/elasticsearch">Elasticsearch</a></li><li class="cat-item cat-item-99"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/flume">flume</a></li><li class="cat-item cat-item-104"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/graphlab">graphlab</a></li><li class="cat-item cat-item-91"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/hadoop">hadoop</a></li><li class="cat-item cat-item-93"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/hbase">hbase</a></li><li class="cat-item cat-item-92"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/hive">hive</a></li><li class="cat-item cat-item-89"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/html">html</a></li><li class="cat-item cat-item-87"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/http">http</a></li><li class="cat-item cat-item-53"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/javascript">javascript</a></li><li class="cat-item cat-item-100"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/kafka">kafka</a></li><li class="cat-item cat-item-108"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/keras">Keras</a></li><li class="cat-item cat-item-88"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/linux">linux</a></li><li class="cat-item cat-item-41"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/lua-%e9%95%bf%e6%96%87%e7%ab%a0">Lua</a></li><li class="cat-item cat-item-10"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/mfc">MFC</a></li><li class="cat-item cat-item-80"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/mongodb">mongodb</a></li><li class="cat-item cat-item-86"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/mysql">mysql</a></li><li class="cat-item cat-item-96"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/node">node</a></li><li class="cat-item cat-item-103"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/node-js">node.js</a></li><li class="cat-item cat-item-7"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/objective-c">Objective-C</a></li><li class="cat-item cat-item-58"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/opencv">OpenCV</a></li><li class="cat-item cat-item-82"><a href="http://www.waitingfy.com/archives/category/%e7%9f%ad%e6%96%87%e7%ab%a0/other">other</a></li><li class="cat-item cat-item-90"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/pandas">pandas</a></li><li class="cat-item cat-item-69"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/photoshop">photoshop</a></li><li class="cat-item cat-item-83"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/php">php</a></li><li class="cat-item cat-item-72"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/python">Python</a></li><li class="cat-item cat-item-85"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/pytorch">pytorch</a></li><li class="cat-item cat-item-27"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/qt">qt</a></li><li class="cat-item cat-item-73"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/quant">quant</a></li><li class="cat-item cat-item-81"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/react-native">react native</a></li><li class="cat-item cat-item-66"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/redis">redis</a></li><li class="cat-item cat-item-95"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/scala">scala</a></li><li class="cat-item cat-item-78"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/scrapy">scrapy</a></li><li class="cat-item cat-item-106"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/sklearn">sklearn</a></li><li class="cat-item cat-item-94"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/spark">spark</a></li><li class="cat-item cat-item-105"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/spark-mllib">Spark mllib</a></li><li class="cat-item cat-item-101"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/spark-streaming">spark streaming</a></li><li class="cat-item cat-item-77"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/spring">Spring</a></li><li class="cat-item cat-item-102"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/storm">storm</a></li><li class="cat-item cat-item-76"><a href="http://www.waitingfy.com/archives/category/%e7%9f%ad%e6%96%87%e7%ab%a0/talib">talib</a></li><li class="cat-item cat-item-107"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/tensorflow">tensorflow</a></li><li class="cat-item cat-item-22"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/wordpress">wordpress</a></li><li class="cat-item cat-item-84"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/yii">yii</a></li><li class="cat-item cat-item-12"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/%e5%85%b6%e4%bb%96%e6%95%99%e7%a8%8b">其他教程</a></li><li class="cat-item cat-item-67"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/%e5%8a%a8%e7%94%bb">动画</a></li><li class="cat-item cat-item-51"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/%e5%a4%96%e6%8c%82">外挂</a></li><li class="cat-item cat-item-60"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/%e5%ae%89%e5%85%a8">安全</a></li><li class="cat-item cat-item-16"><a href="http://www.waitingfy.com/archives/category/%e7%9f%ad%e6%96%87%e7%ab%a0/%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84-%e7%ae%97%e6%b3%95">数据结构 &amp; 算法</a></li><li class="cat-item cat-item-1"><a href="http://www.waitingfy.com/archives/category/uncategorized">未分类</a></li><li class="cat-item cat-item-62"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/%e6%a6%82%e7%8e%87">概率</a></li><li class="cat-item cat-item-65"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/%e6%b8%b8%e6%88%8f%e7%ae%80%e5%8d%95%e7%89%b9%e6%95%88%e5%ae%9e%e7%8e%b0">游戏简单特效实现</a></li><li class="cat-item cat-item-20"><a href="http://www.waitingfy.com/archives/category/%e7%9f%ad%e6%96%87%e7%ab%a0">短文章</a></li><li class="cat-item cat-item-64"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f">设计模式</a></li></ul></li><li>文章归档<ul><li><a href="http://www.waitingfy.com/archives/date/2019/07">2019年七月</a></li><li><a href="http://www.waitingfy.com/archives/date/2019/05">2019年五月</a></li><li><a href="http://www.waitingfy.com/archives/date/2019/03">2019年三月</a></li><li><a href="http://www.waitingfy.com/archives/date/2019/02">2019年二月</a></li><li><a href="http://www.waitingfy.com/archives/date/2019/01">2019年一月</a></li><li><a href="http://www.waitingfy.com/archives/date/2018/12">2018年十二月</a></li><li><a href="http://www.waitingfy.com/archives/date/2018/11">2018年十一月</a></li><li><a href="http://www.waitingfy.com/archives/date/2018/10">2018年十月</a></li><li><a href="http://www.waitingfy.com/archives/date/2018/09">2018年九月</a></li><li><a href="http://www.waitingfy.com/archives/date/2018/08">2018年八月</a></li><li><a href="http://www.waitingfy.com/archives/date/2018/07">2018年七月</a></li><li><a href="http://www.waitingfy.com/archives/date/2018/06">2018年六月</a></li><li><a href="http://www.waitingfy.com/archives/date/2018/05">2018年五月</a></li><li><a href="http://www.waitingfy.com/archives/date/2018/04">2018年四月</a></li><li><a href="http://www.waitingfy.com/archives/date/2018/03">2018年三月</a></li><li><a href="http://www.waitingfy.com/archives/date/2017/11">2017年十一月</a></li><li><a href="http://www.waitingfy.com/archives/date/2017/10">2017年十月</a></li><li><a href="http://www.waitingfy.com/archives/date/2017/08">2017年八月</a></li><li><a href="http://www.waitingfy.com/archives/date/2017/07">2017年七月</a></li><li><a href="http://www.waitingfy.com/archives/date/2017/05">2017年五月</a></li><li><a href="http://www.waitingfy.com/archives/date/2016/08">2016年八月</a></li><li><a href="http://www.waitingfy.com/archives/date/2016/07">2016年七月</a></li><li><a href="http://www.waitingfy.com/archives/date/2016/03">2016年三月</a></li><li><a href="http://www.waitingfy.com/archives/date/2015/12">2015年十二月</a></li><li><a href="http://www.waitingfy.com/archives/date/2015/10">2015年十月</a></li><li><a href="http://www.waitingfy.com/archives/date/2015/09">2015年九月</a></li><li><a href="http://www.waitingfy.com/archives/date/2015/08">2015年八月</a></li><li><a href="http://www.waitingfy.com/archives/date/2015/07">2015年七月</a></li><li><a href="http://www.waitingfy.com/archives/date/2015/06">2015年六月</a></li><li><a href="http://www.waitingfy.com/archives/date/2015/05">2015年五月</a></li><li><a href="http://www.waitingfy.com/archives/date/2015/04">2015年四月</a></li><li><a href="http://www.waitingfy.com/archives/date/2015/03">2015年三月</a></li><li><a href="http://www.waitingfy.com/archives/date/2015/02">2015年二月</a></li><li><a href="http://www.waitingfy.com/archives/date/2015/01">2015年一月</a></li><li><a href="http://www.waitingfy.com/archives/date/2014/12">2014年十二月</a></li><li><a href="http://www.waitingfy.com/archives/date/2014/11">2014年十一月</a></li><li><a href="http://www.waitingfy.com/archives/date/2014/10">2014年十月</a></li><li><a href="http://www.waitingfy.com/archives/date/2014/09">2014年九月</a></li><li><a href="http://www.waitingfy.com/archives/date/2014/08">2014年八月</a></li><li><a href="http://www.waitingfy.com/archives/date/2014/07">2014年七月</a></li><li><a href="http://www.waitingfy.com/archives/date/2014/06">2014年六月</a></li><li><a href="http://www.waitingfy.com/archives/date/2014/05">2014年五月</a></li><li><a href="http://www.waitingfy.com/archives/date/2014/04">2014年四月</a></li><li><a href="http://www.waitingfy.com/archives/date/2014/03">2014年三月</a></li><li><a href="http://www.waitingfy.com/archives/date/2014/02">2014年二月</a></li><li><a href="http://www.waitingfy.com/archives/date/2014/01">2014年一月</a></li><li><a href="http://www.waitingfy.com/archives/date/2013/12">2013年十二月</a></li><li><a href="http://www.waitingfy.com/archives/date/2013/11">2013年十一月</a></li><li><a href="http://www.waitingfy.com/archives/date/2013/10">2013年十月</a></li><li><a href="http://www.waitingfy.com/archives/date/2013/09">2013年九月</a></li><li><a href="http://www.waitingfy.com/archives/date/2013/08">2013年八月</a></li><li><a href="http://www.waitingfy.com/archives/date/2013/07">2013年七月</a></li><li><a href="http://www.waitingfy.com/archives/date/2013/06">2013年六月</a></li><li><a href="http://www.waitingfy.com/archives/date/2013/05">2013年五月</a></li><li><a href="http://www.waitingfy.com/archives/date/2013/04">2013年四月</a></li><li><a href="http://www.waitingfy.com/archives/date/2013/03">2013年三月</a></li><li><a href="http://www.waitingfy.com/archives/date/2013/02">2013年二月</a></li><li><a href="http://www.waitingfy.com/archives/date/2013/01">2013年一月</a></li><li><a href="http://www.waitingfy.com/archives/date/2012/12">2012年十二月</a></li><li><a href="http://www.waitingfy.com/archives/date/2012/11">2012年十一月</a></li><li><a href="http://www.waitingfy.com/archives/date/2012/10">2012年十月</a></li><li><a href="http://www.waitingfy.com/archives/date/2012/09">2012年九月</a></li><li><a href="http://www.waitingfy.com/archives/date/2012/08">2012年八月</a></li><li><a href="http://www.waitingfy.com/archives/date/2012/07">2012年七月</a></li><li><a href="http://www.waitingfy.com/archives/date/2012/05">2012年五月</a></li><li><a href="http://www.waitingfy.com/archives/date/2012/04">2012年四月</a></li></ul></li><li>近期评论<ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link">Hbase 简单java API 操作 | 麦叶</span>发表在《<a href="http://www.waitingfy.com/archives/4607#comment-3854">Hbase 简单java API 操作</a>》</li><li class="recentcomments"><span class="comment-author-link">spark streaming 中使用 spark sql | 麦叶</span>发表在《<a href="http://www.waitingfy.com/archives/4236#comment-3853">spark streaming 中使用 spark sql</a>》</li><li class="recentcomments"><span class="comment-author-link">flume 从log4j 收集日志 到kafka | 麦叶</span>发表在《<a href="http://www.waitingfy.com/archives/4271#comment-3521">flume 从log4j 收集日志 到kafka</a>》</li><li class="recentcomments"><span class="comment-author-link">Storm 整合kafka | 麦叶</span>发表在《<a href="http://www.waitingfy.com/archives/4561#comment-3504">Storm 整合kafka</a>》</li><li class="recentcomments"><span class="comment-author-link">Storm 整合 Hbase | 麦叶</span>发表在《<a href="http://www.waitingfy.com/archives/4551#comment-3494">Storm 整合 Hbase</a>》</li></ul></li><li>功能<ul><li><a href="http://www.waitingfy.com/wp-login.php">登录</a></li><li><a href="http://www.waitingfy.com/feed">文章<abbr title="Really Simple Syndication">RSS</abbr></a></li><li><a href="http://www.waitingfy.com/comments/feed">评论<abbr title="Really Simple Syndication">RSS</abbr></a></li><li><a href="https://cn.wordpress.org/" title="基于WordPress，一个优美、先进的个人信息发布平台。">WordPress.org</a></li></ul></li><li>友情链接<div class="textwidget custom-html-widget"><div> <a href="http://www.codeblogbt.com/" target="_blank"> CodeBlogBt</a></div><div> <a href="http://www.datahalf.com/" target="_blank"> datahalf</a></div></div></li></ul></div><div id="sidebar2" class="sides"><ul><li>我的新浪微博<div class="textwidget"><p>本站文章未特殊说明都是原创文章，请勿未经允许，进行转载。转载请注明出处，谢谢。</p><p><iframe class="share_self" scrolling="no" src="./DX9 使用 Shader教程_files/index.html" frameborder="0" width="100%"></iframe><br> <br> <a href="http://www.waitingfy.com/archives/1174" target="_blank"><br> <img src="http://www.waitingfy.com/wp-content/uploads/2014/08/newad.jpg" alt="digital ocean"><br> </a></p></div></li><li>AD<div class="textwidget custom-html-widget"><script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>  <ins class="adsbygoogle" style="display:inline-block;width:160px;height:600px" data-ad-client="ca-pub-0295086493266141" data-ad-slot="6135632041"></ins> <script>(adsbygoogle = window.adsbygoogle || []).push({});</script> <img src="./DX9 使用 Shader教程_files/WechatIMG68.jpeg" style="width:175px;height:262px;"></div></li></ul></div></div><div class="clear whitespace"></div><div id="footer"><div style="display:none"> <script type="text/javascript">var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F8733a4db37a8a51f4325a6afef9a519e' type='text/javascript'%3E%3C/script%3E"));</script><script src="./DX9 使用 Shader教程_files/h.js.下载" type="text/javascript"></script><a href="http://tongji.baidu.com/hm-web/welcome/ico?s=8733a4db37a8a51f4325a6afef9a519e" target="_blank"><img border="0" src="./DX9 使用 Shader教程_files/21.gif" width="20" height="20"></a> </div><p> <a href="http://wordpress.org/">Powered by WordPress</a> | <a href="http://www.waitingfy.com/feed">Entries (RSS)</a> | <a href="http://www.waitingfy.com/comments/feed">Comments (RSS)</a> | <a href="http://rosecitygardens.com/" title="free WordPress themes">Green Apple WordPress™ Theme by RoseCityGardens.com</a></p><div id="my_ad1" style="margin-bottom:0px;"> <script type="text/javascript">/*<![CDATA[*/google_ad_client = "ca-pub-0295086493266141";
/* 728x90&#25991;&#23383; */
google_ad_slot = "3044400839";
google_ad_width = 728;
google_ad_height = 90;/*]]>*/</script> <script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script> </div></div><div id="absnav"><div class="menu-menu-container"><ul id="nav"><li id="menu-item-1899" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1899"><a href="http://www.waitingfy.com/archives/category/%e9%95%bf%e6%96%87%e7%ab%a0/cocos2d-x">cocos2d-x</a></li><li id="menu-item-1900" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1900"><a href="http://www.waitingfy.com/">首页</a></li><li id="menu-item-1901" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1901"><a href="http://www.waitingfy.com/archives/category/%e7%9f%ad%e6%96%87%e7%ab%a0">短文章</a></li><li id="menu-item-1902" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1902"><a href="http://www.waitingfy.com/sample-page-2">About Me</a></li><li id="menu-item-1903" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1903"><a href="http://www.waitingfy.com/qt_software">做的一些游戏制作小软件</a></li><li id="menu-item-1904" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1904"><a href="http://www.waitingfy.com/games_list">我独立制作或者参与的游戏作品</a></li><li id="menu-item-5212" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5212"><a href="http://www.waitingfy.com/html5/snake">snake AI</a></li></ul></div></div>  <script type="text/javascript" src="./DX9 使用 Shader教程_files/autoptimize_single_488ca2f56c37f84283fc9be63219304f.js.下载"></script> <script type="text/javascript" src="./DX9 使用 Shader教程_files/autoptimize_single_a122e7137e224f646b22b910a779d211.js.下载"></script> <script type="text/javascript" src="./DX9 使用 Shader教程_files/autoptimize_single_ba290ac0111d2c3f8e1ce36fbaf6a239.js.下载"></script> <script type="text/javascript">//
	SyntaxHighlighter.autoloader(
	"applescript	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushAppleScript.js?ver=3.0"
	,"as3 actionscript3	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushAS3.js?ver=3.0"
	,"bash shell	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushBash.js?ver=3.0"
	,"cf coldfusion	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushColdFusion.js?ver=3.0"
	,"cpp c	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCpp.js?ver=3.0"
	,"c# c-sharp csharp	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0"
	,"css	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCss.js?ver=3.0"
	,"delphi pas pascal	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushDelphi.js?ver=3.0"
	,"diff patch	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushDiff.js?ver=3.0"
	,"erl erlang	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushErlang.js?ver=3.0"
	,"groovy	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushGroovy.js?ver=3.0"
	,"java	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJava.js?ver=3.0"
	,"jfx javafx	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJavaFX.js?ver=3.0"
	,"js jscript javascript	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0"
	,"perl pl	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPerl.js?ver=3.0"
	,"php	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPhp.js?ver=3.0"
	,"plain text	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPlain.js?ver=3.0"
	,"ps powershell	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPowerShell.js?ver=3.0"
	,"py python	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0"
	,"rails ror ruby rb	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0"
	,"sass scss	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushSass.js?ver=3.0"
	,"scala	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushScala.js?ver=3.0"
	,"sql	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushSql.js?ver=3.0"
	,"vb vbnet	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushVb.js?ver=3.0"
	,"xml xhtml xslt html	http://www.waitingfy.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0"
	);
	SyntaxHighlighter.defaults['auto-links'] = true;
	SyntaxHighlighter.defaults['quick-code'] = true;
	SyntaxHighlighter.defaults['title'] = '';
	SyntaxHighlighter.defaults['class-name'] = 'notranslate';
	SyntaxHighlighter.defaults['collapse'] = false;
	SyntaxHighlighter.defaults['first-line'] = 1;
	SyntaxHighlighter.defaults['gutter'] = true;
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['smart-tabs'] = true;
	SyntaxHighlighter.defaults['tab-size'] = 4;
	SyntaxHighlighter.defaults['toolbar'] = true;
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = "Can't find brush for: ";
	SyntaxHighlighter.config.strings.brushNotHtmlScript = "Brush wasn't configured for html-script option: ";
	SyntaxHighlighter.all();
	
//</script>  <script type="text/javascript">var pvcArgsFrontend = {"mode":"ajax","requestURL":"http:\/\/www.waitingfy.com\/wp-content\/plugins\/post-views-counter\/includes\/ajax.php","postID":"395","nonce":"cb91b26177"};</script> <script type="text/javascript">var tocplus = {"visibility_show":"show","visibility_hide":"hide","width":"Auto"};</script> <script type="text/javascript">var mv_dynamic_to_top = {"text":"To Top","version":"0","min":"300","speed":"1100","easing":"easeInExpo","margin":"20"};</script> <script type="text/javascript" defer="" src="./DX9 使用 Shader教程_files/autoptimize_1d3ac3609175df756fe34c2aeb9e17d3.js.下载"></script>
<!-- Dynamic page generated in 0.122 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2019-08-14 09:35:51 -->

<!-- super cache --></body></html>